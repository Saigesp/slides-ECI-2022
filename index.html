<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Analizando datos, visualizando informaci√≥n, contando historias</title>
    <meta charset="utf-8" />
    <meta name="author" content="Autores: Javier √Ålvarez Li√©bana y Gabriel Valverde Castilla (UCM)" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/animate.css/animate.xaringan.css" rel="stylesheet" />
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Click para copiar c√≥digo","success":"C√≥digo copiado","error":"Ctrl+C para copiar"})</script>
    <script src="libs/freezeframe/freezeframe.min.js"></script>
    <script src="libs/xaringanExtra-freezeframe/freezeframe-init.js"></script>
    <script id="xaringanExtra-freezeframe-options" type="application/json">{"selector":"img[src$=\"gif\"]","trigger":"click","overlay":false,"responsive":true,"warnings":true}</script>
    <link href="libs/animate.css-xaringan/animate.fade.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Analizando datos, visualizando informaci√≥n, contando historias
## Curso de la ECI 2022
### Autores: Javier √Ålvarez Li√©bana y Gabriel Valverde Castilla (UCM)
### Facultad de Estudios Estad√≠sticos (UCM)
### 31/01/2022 - 04/02/2022 (actualizado: 2022-01-22)

---





class: inverse center middle

# PRESENTACI√ìN DEL CURSO



`$$\\[2.7in]$$`

.left[Pulsa &lt;kbd-black&gt;O&lt;/kbd-black&gt; para ver el panel de diapositivas]
.left[Pulsa &lt;kbd-black&gt;H&lt;/kbd-black&gt; para ver otros atajos]

---


# Material del curso

&lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/imagen_curso.jpeg" alt = "course-ECI" align = "right" width = "360" style = "margin-top: 20vh;margin-right: 0.5rem;margin-left: 1rem;"&gt;

- **Web** del curso:

&lt;https://dadosdelaplace.github.io/curso-dataviz-ECI-2022&gt;



- **Diapositivas** del curso ([**c√≥digo R de las diapositivas**](https://github.com/dadosdelaplace/slides-ECI-2022)):

&lt;https://dadosdelaplace.github.io/slides-ECI-2022&gt;



- **Manual** del curso ([**c√≥digo R del manual**](https://github.com/dadosdelaplace/courses-ECI-2022)):

&lt;https://dadosdelaplace.github.io/courses-ECI-2022&gt;



- **Scripts** del curso:

&lt;https://github.com/dadosdelaplace/courses-ECI-2022/tree/main/scripts&gt;


&amp;nbsp;

- **Grupo de Telegram** para dudas, preguntas y dem√°s cosicas:

&lt;https://t.me/curso_dataviz_ECI&gt;

---


# Objetivos

&lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/imagen_curso.jpeg" alt = "course-ECI" align = "right" width = "360" style = "margin-top: 20vh;margin-right: 0.5rem;margin-left: 1rem;"&gt;

¬°Bienvenidos/as/es!

Tomen asiento, entren a la secta del **software libre** y dejen sus Excel en la entrada



El **objetivo** del curso no es ser un/a sesudo/a programador/a de `R`, sino adquirir los suficientes conocimientos como para lograr 5 objetivos:


- **Perder el miedo** a programar.
- Entender los [**conceptos b√°sicos de R**](https://cran.rstudio.com/), lenguaje estad√≠stico por excelencia, desde cero.
- Dotarnos de **autonom√≠a en el an√°lisis** de datos.
- Crear programas y flujos de trabajo **reproducibles** y mantenibles.
- Adquirir habilidades en la **visualizaci√≥n de datos** en `R` (haciendo uso tambi√©n de otras herramientas como [**Datawrapper**](https://www.datawrapper.de/)), incluyendo la visualizaci√≥n de datos en **mapas**.


&amp;nbsp;

üìö Estas **diapositivas** han sido elaboradas con el propio `R` haciendo uso del paquete `{xaringan}`
y `{xaringanExtra}`.

---

# A programar se aprende programando

&lt;video width = "1000" height = "480" align = "middle" controls&gt;
  &lt;source src = "./img/programming_skills.mp4" type = "video/mp4"&gt;
&lt;/video&gt;

**Desmitifiquemos** la programaci√≥n: es cuesti√≥n de pr√°ctica, de tiempo, de pruebas y de muchos errores. **Desdramaticemos** equivocarnos con un ordenador.

---

class: inverse middle

### BLOQUE I. Introducci√≥n a R desde cero

* Instalaci√≥n de R y RStudio. Primeros pasos. Tipos de datos.
* Datos estructurados: matrices y data.frame
* Extras: estructuras de control, proyectos, funciones y datos en formato tibble


### BLOQUE II. Introducci√≥n a dataviz y  estad√≠stica con R

* Introducci√≥n a estad√≠stica b√°sica: centralizaci√≥n y dispersi√≥n, conceptos de regresi√≥n e inferencia.
* Tidy data. Introducci√≥n a Tidyverse
* Dataviz: la importancia de visualizar datos. Introducci√≥n a ggplot2. Visualizaci√≥n en tablas

### BLOQUE III. Periodismo de datos

Impartido por Borja Andrino, Javier √Ålvarez Li√©bana y Gabriel Valverde Castilla.

### BLOQUE IV. Story Telling

Impartido por Vict√≤ria Oliveres, Javier √Ålvarez Li√©bana y Gabriel Valverde Castilla.

### BLOQUE V. Visualizaci√≥n de datos en mapas

Impartido por Dominic Roy√©, Javier √Ålvarez Li√©bana y Gabriel Valverde Castilla.

---

class: inverse center middle

# Bloque I: introducci√≥n a R desde cero.

&amp;nbsp;

### [Instalaci√≥n y primeros pasos](#instalacion-primeros-pasos)

### [Celdas: tipos de datos](#tipos-datos)

### [Columnas: vectores](#vectores)

### [Tablas: estructuras de datos](#matrices-dataframes)

### [Extras: estructuras de control](#estructuras)

### [Primer proyecto. Funciones](#proyecto-funciones)

### [Mejorando los datos: tibble](#tibble)

### [Caso pr√°ctico: informe RMarkdown](#rmarkdown)

### [üèÖEvaluaci√≥n](#evaluacion)

---
name: instalacion-primeros-pasos
class: center, middle

# Instalaci√≥n y primeros pasos

## **Instalaci√≥n de R**

&amp;nbsp;

Programaremos como escribimos un libro: necesitamos una **gram√°tica** (`R`) y un **Word** (`RStudio`).

---

# Requisitos del curso

Para el presente curso los √∫nicos **requisitos** ser√°n:

1. **Conexi√≥n a internet** (para la descarga de algunos datos y paquetes).

2. **Instalar R**: ser√° nuestro **lenguaje**, nuestro **castellano** para poder ¬´comunicarnos con el ordenador. La descarga la haremos (gratuitamente) desde &lt;https://cran.r-project.org/&gt;

3. **Instalar R Studio**. De la misma manera que podemos escribir castellano en un ordenador, en un Word, en un papel o en un tuit, podemos usar distintos IDE (entornos de desarrollo integrados, nuestro Office), para que el trabajo sea m√°s c√≥modo. Nuestro **Word** para nosotros ser√° **RStudio**.

.left[
  &lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/cran-R.jpg" alt = "cran-R" align = "left" width = "500" style = "margin-top: 5vh"&gt;
]
.right[
  &lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/R-studio.jpg" alt = "RStudio" align = "right" width = "500" style = "margin-top: 5vh;"&gt;
]

---

# Instalaci√≥n de R

El **lenguaje de programaci√≥n R** ser√° nuestra **gram√°tica**, nuestra ortograf√≠a y nuestro diccionario

&amp;nbsp;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/pantalla1_cran.jpg" alt = "cran-R" align = "right" width = "500" style = "margin-top: 10vh;margin-right: 0.5rem;margin-left: 1rem;"&gt;

* **Paso 1**: entra en la [web oficial de R](https://cran.r-project.org/) y selecciona la instalaci√≥n acorde a tu sistema operativo.

* **Paso 2**: para **Mac** basta con que hacer click en el archivo **.pkg**, y abrirlo una vez descargado. Para sistemas **Windows**, debemos clickar en `install R for the first time` y en la siguiente pantalla hacer click en `Download R for Windows`. Una vez descargado, **abrirlo como cualquier archivo de instalaci√≥n**.

* **Paso 3**: abrir el **ejecutable** de tu escritorio o en tu Launchap (en Windows puede que tengas dos ejecutables i386 y x64, la versi√≥n de 32 y de 64 bits; haz click preferiblemente en el de x64).

---

# Primera operaci√≥n

Para comprobar que se ha instalado correctamente, tras abrir `R`, deber√≠as ver una **pantalla blanca** similar a esta (en realidad se llama **consola**)

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/cranR.jpg" alt = "consola" align = "left" width = "350" style = "margin-top: 5vh;margin-right: 3rem;"&gt;

Vamos a escribir **nuestra primera operaci√≥n** en la consola:

* Una variable llamada `a` le asignaremos el valor `1`. En `R` asignaremos valores con `&lt;-`, como una flecha: `a &lt;- 1` significa que a una variable que llamamos a le asignamos el valor 1.

* Una variable llamada `b` le asignaremos el valor `2`.

* **Sumamos las variables** haciendo `a + b`.


```r
# Primera operaci√≥n
a &lt;- 1 # Una variable a con valor --&gt; 1
b &lt;- 2 # Una variable b con valor --&gt; 2
*a + b
```

El **resultado** que nos devuelve la consola ser√° 3 (2 + 1).


```
&gt; [1] 3
```


---

# Instalaci√≥n de R Studio

El **Word**  que usaremos para trabajar y escribir en nuestro lenguaje ser√° **RStudio** (lo que se conoce como un IDE: entorno integrado de desarrollo).

&amp;nbsp;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/pantalla_rstudio.jpg" alt = "RStudio" align = "right" width = "450" style = "margin-top: 10vh;margin-right: 2rem;"&gt;

* **Paso 1**: entra la [web oficial de RStudio](https://www.rstudio.com/products/rstudio/download/#download) y selecciona la descarga gratuita.

* **Paso 2**: selecciona el ejecutable que te aparezca acorde a tu sistema operativo. 

* **Paso 3**: tras descargar el ejecutable, hay que abrirlo como otro cualquier otro ejecutable y dejar que termine la instalaci√≥n.


---

# Organizaci√≥n de RStudio

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/inicio_rstudio_2.jpg" alt = "Rstudio" align = "left" width = "333" style = "margin-top: 3vh;margin-right: 2rem;margin-bottom: 1vh;"&gt;
&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/inicio_rstudio_3.jpg" alt = "Rstudio" align = "left" width = "283" style = "margin-top: 3vh;margin-right: 2rem;margin-bottom: 1vh;"&gt;
&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/inicio_rstudio_4.jpg" alt = "Rstudio" align = "left" width = "298" style = "margin-top: 3vh;margin-right: 2rem;margin-bottom: 1vh;"&gt;


&amp;nbsp;



* **Consola**: es el nombre para llamar a la ventana grande que te ocupa buena parte de tu pantalla. Prueba a escribir el mismo c√≥digo que antes (la suma) en ella. La consola ser√° donde **ejecutaremos √≥rdenes y mostraremos resultados**.

* **Environment (entorno de variables)**: la pantalla peque√±a (puedes ajustar los m√°rgenes con el rat√≥n a tu gusto) que tenemos en la parte superior derecha. Nos mostrar√° las **variables que tenemos definidas, el tipo y su valor**.

* **Panel multiusos**: la ventana que tenemos en la parte inferior derecha no servir√° para buscar **ayuda de funciones**, adem√°s de para **visualizar gr√°ficos**. 



---

# Tips de RStudio: modo oscuro


&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/menu_1.jpg" alt = "Rstudio" align = "left" width = "300" style = "margin-top: 3vh;margin-right: 2rem;"&gt;
&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/menu_2.jpg" alt = "Rstudio" align = "left" width = "350" style = "margin-top: 3vh;margin-right: 2rem;"&gt;

**Consejo**: cambiar en tu `RStudio` la tonalidad del fondo de tu programa, en tonos oscuros y no blancos.

---

# ¬øQu√© es R?

&lt;img src = "https://logos.turbio.repl.co/rlang.svg" alt = "Rstudio" align = "left" width = "350" style = "margin-top: 3vh;margin-right: 2rem;"&gt;


&amp;nbsp;



`R` es un **lenguaje estad√≠stico**, creado por y para la estad√≠stica, con 4 ventajas fundamentales:

--

* **Software libre** (como C++, Python, Fortran, y otros tantos lenguajes). El software libre no solo tiene una ventaja evidente (es gratis, ok) sino que permite **acceder libremente a c√≥digo ajeno**.

--

* **Lenguaje modular**: en la instalaci√≥n que hemos realizado no se han instalado todas las funcionalidades, solo el m√≠nimo para poder funcionar, de forma que se ahorra espacio en disco y en memoria. Al ser software libre, existen trozos de **c√≥digo hechos por otras personas llamados paquetes**, que podemos ir instalando a nuestro gusto seg√∫n los vayamos necesitando.

--

* **Gran comunidad de usuarios**: `R` tiene una comunidad de usuarios gigante para hacer estad√≠stica (Python tiene una enorme comunidad pero m√°s enfocada al Machine Learning), con m√°s de 18 000 paquetes.

--

* **Lenguaje de alto nivel**. Los lenguajes de alto nivel, como `R` o `Python`, facilitan la programaci√≥n al usuario, teniendo que preocuparte solo de la tarea de programar. Son lenguajes con una menor curva de aprendizaje aunque suelen ser m√°s lentos en su ejecuci√≥n en comparaci√≥n con lenguajes de bajo nivel (`C`, `C++` o `Fortran`).

---

class: inverse center middle

COMPRAR un libro --&gt; instalar un paquete (una sola vez) `install.packages()`
&lt;figure&gt;
&lt;img src = "https://cdn.cienradios.com/wp-content/uploads/sites/14/2020/09/Book-Depository-2.jpg" alt = "comprar-libros" align = "middle" width = "480" style = "margin-top: 1vh;"&gt;
&lt;/figure&gt;

SELECCIONAR un libro (ya comprado) --&gt; acceder a un paquete ya instalado (en cada sesi√≥n que queramos usarlo) `library()`
&lt;figure&gt;
&lt;img src = "https://cdn.sincroguia.tv/uploads/programs/l/a/-/la-biblioteca-de-los-libros-rechazados-704306_SPA-77.jpg" alt = "comprar-libros-2" align = "middle" width = "480" style = "margin-top: 1vh;"&gt;
&lt;/figure&gt;


---

# Paquetes en R

Como hemos mencionado, existen trozos de **c√≥digo hechos por otras personas llamados paquetes**, que podemos ir instalando a nuestro gusto seg√∫n los vayamos necesitando.


&amp;nbsp;


A lo largo del curso usaremos varios de esos paquetes, pero el m√°s importante para nuestro objetivo es el paquete `{ggplot2}`, un paquete para la **elaboraci√≥n de visualizaciones de datps**. Vamos a instalarlo (necesitamos internet para ello) con la orden `install.packages("ggplot")`


```r
install.packages("ggplot2")
```


&amp;nbsp;



La **instalaci√≥n de un paquete** es el equivalente a comprar a un libro: solo lo debemos hacer **la primera vez** que lo usemos en un ordenador (descarg√°ndose los archivos del paquete a nuestro local). Una vez que tenemos comprado nuestro libro, para poder usarlo, simplemente debemos **indicar al programa que nos lo acerque de la estanter√≠a** con `library(ggplot2)`.


```r
library(ggplot2)
```

---

class: inverse center middle

# ¬øPor qu√© no usar Excel?


&lt;img src = "https://upload.wikimedia.org/wikipedia/commons/9/92/Soup_Spoon.jpg" alt = "cuchara" align = "middle" width = "600" style = "margin-top: 3vh;"&gt;


Excel es una excelente cuchara: puedes ser el mejor partiendo un filete con una cuchara, pero seguir√°s siendo una persona comiendo filete con cuchara.

---

# ¬øPor qu√© no usar Excel?

Excel es una **hoja de c√°lculo**, ni m√°s ni menos, y el propio **Microsoft desaconseja el uso de Excel para el an√°lisis de datos**. El Excel es una herramienta maravillosa para ser usada como una sencilla hoja de c√°lculo:

* Llevar las cuentas de tu familia.
* Una declaraci√≥n de Renta sencilla.
* Planificar viajes

&amp;nbsp;

**NO EST√Å DISE√ëADO** para ser una base de datos, y muchos menos pensado para generar un entorno flexible para el an√°lisis estad√≠stico y la visualizaci√≥n de datos, con algunas desventajas:


* **Software de pago** (bien por el usuario, bien por la administraci√≥n o empresa).

* **Software cerrado**: solo podemos hacer lo que Excel ha cre√≠do que interesante que podamos hacer. Incluso con la programaci√≥n de macros, las funcionalidades de Excel siguen siendo mucho m√°s limitadas

* **Alto consumo de memoria**.

* **No es universal**: no solo es de pago sino que adem√°s, dependiendo de la versi√≥n que tengas de Excel, tendr√° un formato distinto para datos como fechas, teniendo incluso extensiones distintas.

---


# Epic fails en Excel


.pull-left[&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/excel_genes.jpg" alt = "Rstudio" align = "left" width = "250"&gt;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/excel_uk.jpg" alt = "Rstudio" align = "left" width = "250"&gt;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/excel_edades.jpg" alt = "Rstudio" align = "left" width = "250"&gt;]

.pull-right[



&amp;nbsp;




## Problemas de **versiones**


&amp;nbsp;



&amp;nbsp;




## Problemas de **memoria**



&amp;nbsp;



## Problemas de **codificaci√≥n**



]

---

# Primeros pasos en R: calculadora

Empecemos por lo sencillo: **¬øc√≥mo usar R como una calculadora?** Si escribimos `2 + 1` en la consola y pulsamos ENTER, la consola nos mostrar√° el resultado de la suma.


```r
2 + 1
```

```
&gt; [1] 3
```

&amp;nbsp;

Si dicha suma la quisi√©ramos utilizar para un segundo c√°lculo: ¬øy si la **almacenamos en alguna variable**?


```r
*x &lt;- 2 + 1
x + 3
```

```
&gt; [1] 6
```

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/environment_1.jpg" alt = "environment" align = "right" width = "450"&gt;



```r
y &lt;- 5
x + y
```

```
&gt; [1] 8
```

---

# Primeros pasos en R: calculadora

### Multiplicaci√≥n


```r
x * y
```

### Elevar al cuadrado


```r
x^2
```

### Valor absoluto


```r
abs(x)
```

### Ra√≠z cuadrada


```r
sqrt(-1)
```

```
&gt; Warning in sqrt(-1): Se han producido NaNs
```

```
&gt; [1] NaN
```

---

# Errores

Durante tu aprendizaje va a ser **muy habitual que las cosas no salgan a la primera**, apareciendo en consola mensajes en un color rojo. Un miedo muy habitual cuando se empieza a programar es pensar que si haces algo mal o aparece alg√∫n mensaje de error, el **ordenador puede explotar en cualquier momento**. 

A **programar se aprende programando**, as√≠ que haz las pruebas que quieras.

---

# Mensajes de ¬´error¬ª


* **Mensajes de ERROR**: ir√°n precedidos de la frase `¬´Error in‚Ä¶¬ª`, y ser√°n aquellos **fallos que impidan la ejecuci√≥n del c√≥digo** (un error muy habitual es intentar acceder a funciones de alg√∫n paquete sin tenerlo instalado: est√°s intentando leerte un libro de tu biblioteca pero ni siquiera has ido a la tienda a ¬´comprarlo¬ª). Veamos un ejemplo intentando sumar un n√∫mero a un texto.


```r
"a" + 1
```

```
&gt; Error in "a" + 1: argumento no-num√©rico para operador binario
```

&amp;nbsp;

* Mensajes **WARNING**: ir√°n precedidos de la frase `¬´Warning in‚Ä¶¬ª`, y son los fallos m√°s delicados ya que son posibles incoherencias pero que no van a hacer que tu c√≥digo deje de ejecutarse.


```r
sqrt(-1)
```

```
&gt; Warning in sqrt(-1): Se han producido NaNs
```

```
&gt; [1] NaN
```


**¬øHa ejecutado la orden?** S√≠, pero te advierte de que el resultado de la operaci√≥n es un NaN, _Not A Number_, un valor que no existe (al menos dentro de los n√∫meros reales).


---

# ¬øD√≥nde programamos? Script

Un **script** ser√° el documento en el que programamos, nuestro equivalente a un archivo `.doc`, pero aqu√≠ ser√° un archivo con extensi√≥n `.R`, donde escribiremos las √≥rdenes.

&amp;nbsp;

Es **importante no abusar de la consola**: todo lo que no escribas en un script, cuando cierres `RStudio`, lo habr√°s perdido (c√≥mo si en lugar de escribir en un Word y guardarlo, nunca guardases el documento).

&amp;nbsp;

Para **abrir nuestro primero script**, haz click en el men√∫ superior en `File &lt;&lt; New File &lt;&lt; R Script`.

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/inicio_rstudio_5.jpg" alt = "environment" align = "right" width = "450"&gt;


---

# Ejecutar nuestros scripts

Ahora tenemos una **cuarta ventana**: la ventana donde **escribiremos nuestros c√≥digos**

&amp;nbsp;

### ¬øC√≥mo ejecutar nuestro script?

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/inicio_rstudio_6.jpg" alt = "environment" align = "left" width = "550" style = "margin-top: 3vh;margin-right: 2rem;"&gt;


1. Escribimos el c√≥digo que queremos ejecutar (en este caso, la suma de antes).

2. Guardamos el archivo `.R` haciendo click en el bot√≥n de guardar (`Save current document`)

3. El c√≥digo **no se ejecuta salvo que se lo indiquemos**. Tenemos tres opciones:

  - **Copiar y pegar en consola** el c√≥digo.
  - **Seleccionar las l√≠neas de c√≥digo** a ejecutar y clickar en `Run` (o con su atajo).
  - Activar el cuadrado `Source on save` a la **derecha del bot√≥n de guardar**: no solo se nos guarda sino que se ejecuta el c√≥digo completo.


---

# Primeros ejercicios: trasteando con la consola


.panelset[
.panel[.panel-name[Ejercicios]


* üìù **Ejercicio 1**: en tu consola asigna los valores 2 y 5 a dos variables `a` y `b`. Tras asignarles valores, multiplica los n√∫meros en consola.

* üìù **Ejercicio 2**: modifica el c√≥digo inferior para definir dos variables `c` y `d`, con valores 3 y -1, y calcular la divisi√≥n `c/d`.


```r
c &lt;- # deber√≠as asignarle el valor 3
d &lt;- # deber√≠as asignarle el valor -1

c ? d # modifica el c√≥digo para realizar una divisi√≥n 
```

* üìù **Ejercicio 3**: repite el ejercicio 1 pero ahora guarda el resultado de la multiplicaci√≥n final en una variable `c`. Para ver el resultado guardado en `c` escribe dicha variable en consola.

* üìù **Ejercicio 5**: repite el ejercicio 3 pero ahora escribe el c√≥digo en un script (`script01.R`). Ejecuta el c√≥digo.

]

.panel[.panel-name[Soluci√≥n ej. 1]


```r
# Para poner comentarios en el c√≥digo se usa #

# Definici√≥n de variables
a &lt;- 2
b &lt;- 5

# Multiplicaci√≥n
a * b
```

```
&gt; [1] 10
```
]

.panel[.panel-name[Soluci√≥n ej. 2]


```r
# Definici√≥n de variables
c &lt;- 3
d &lt;- -1

# Divisi√≥n
a / b
```

```
&gt; [1] 0.4
```
]

.panel[.panel-name[Soluci√≥n ej. 3]


```r
# Variables
a &lt;- 2
b &lt;- 5

# Resultado
c &lt;- a * b

# Muestro en consola
c
```

```
&gt; [1] 10
```
]

.panel[.panel-name[Soluci√≥n ej. 5]

&lt;img src = "
https://dadosdelaplace.github.io/courses-ECI-2022/img/consola_multiplicacion_3.jpg" alt = "script01" align = "middle" width = "420" style = "margin-top: 1vh;"&gt;

Tienes todos los scripts en &lt;https://github.com/dadosdelaplace/courses-ECI-2022/blob/main/scripts/&gt; (el  `script01.R` en concreto en &lt;https://github.com/dadosdelaplace/courses-ECI-2022/blob/main/scripts/script01.R&gt;

]
]


---
name: tipos-datos
class: center, middle

# Tipos de datos 

## **Celdas: tipos de datos individuales**

&amp;nbsp;

¬øDe qu√© tipo pueden ser los datos que tenemos contenidos en cada celda de una ¬´tabla¬ª?

---

# Datos: de la celda a la tabla

&lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/celdas.jpg" alt = "celdas" align = "center" width = "850" style = "margin-top: 1vh;"&gt;


* **Celda**: un dato de un tipo concreto.
* **Variable**: concatenaci√≥n de datos del mismo tipo.
* **Matriz**: concatenaci√≥n de variables del mismo tipo y longitud.
* **Tabla**: concatenaci√≥n de variables de distinto tipo pero igual longitud.

---

# Celdas: tipos de datos individuales

**¬øExisten variables m√°s all√° de los n√∫meros?**


&amp;nbsp;

Piensa por ejemplo en los **datos guardados de una persona**:

* La edad o el peso ser√° un **n√∫mero**.
* Su nombre ser√° una cadena de **texto**.
* Su fecha de nacimiento ser√° precisamente eso, una **fecha**.
* A la pregunta ¬´¬øest√° usted soltero/a?¬ª la respuesta ser√° lo que llamamos una **variable binaria o l√≥gica** (`TRUE` si est√° soltero/a o `FALSE` en otro caso).

&lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/celdas.jpg" alt = "celdas" align = "center" width = "600" style = "margin-top: 1vh;"&gt;

---

# Variables num√©ricas

El **dato m√°s sencillo**, dato que ya hemos usado en nuestros primeros pasos como calculadora.


```r
a &lt;- 1
b &lt;- 2
a + b
```

&amp;nbsp;

En el c√≥digo anterior, tanto `a` como `b`, como la suma `a + b`**, son de tipo num√©rico**


```r
# Clase de las variables
class(a)
```

```
&gt; [1] "numeric"
```

```r
# Tipolog√≠a interna
*typeof(a)
```

```
&gt; [1] "double"
```

**Operaciones**: con los datos num√©ricos podemos realizar todas las **operaciones aritm√©ticas** que se nos ocurrir√≠a hacer en una **calculadora**.


```r
b^3
```

```
&gt; [1] 125
```


---

# Variables de texto

No solo de n√∫meros viven los datos: imagina que adem√°s de la edad de una persona queremos guardar su nombre.


```r
edad &lt;- 32
nombre &lt;- "Javier"

class(nombre)
```

```
&gt; [1] "character"
```

```r
typeof(nombre)
```

```
&gt; [1] "character"
```

&amp;nbsp;

La variable `nombre` es de **tipo caracter**: una **cadena de texto** (conocido en otros lenguajes como string o char) entre **comillas**.

Las cadenas de texto son un **tipo especial de dato** con los que obviamente no podremos hacer operaciones aritm√©ticas, pero si podemos hacer **otras operaciones**.

---

# Nuestra primera funci√≥n: paste

Una **funci√≥n** es un **c√≥digo encapsulado**: ejecuta un c√≥digo en funci√≥n de unos **argumentos de entrada**. Nuestra primera funci√≥n ser√° `paste()`: dadas **dos cadenas de texto como argumento de entrada** nos permite pegarlas, indic√°ndole en el **argumento** `sep = ` el caracter que queremos entre medias.


```r
# todo junto, sin espacios, igual a paste0("Javier", "√Ålvarez")
paste("Javier", "√Ålvarez", sep = "") 
```

```
&gt; [1] "Javier√Ålvarez"
```


```r
paste("Javier", "√Ålvarez") # separados por un espacio
```

```
&gt; [1] "Javier √Ålvarez"
```


```r
paste("Javier", "√Ålvarez", sep = ".") # separados por un punto .
```

```
&gt; [1] "Javier.√Ålvarez"
```

**Argumentos por defecto**: `paste(nombre, apellido)` es equivalente a `paste(nombre, apellido, sep = " ")`. El argumento `sep` tiene un **valor por defecto** `sep = " "`: si no se le asigna otro, tomar√° ese por defecto

---

# Nuestro primer paquete: glue

Otra forma **m√°s intuitiva de trabajar con textos** es usar el **paquete** `{glue}`.



```r
install.packages("glue") # solo la primera vez
library(glue)
```



Recuerda que `install.packages()` es solo necesario la primera que ¬´compramos el libro¬ª: cada vez que queramos usarlo bastar√° con `library()`.

&amp;nbsp;

Con dicho paquete podemos **usar variables dentro de cadenas de texto**. Por ejemplo, vamos a crear ¬´la edad es de ... a√±os¬ª, donde la edad concreta la tenemos guardada en una variable `edad`.


```r
edad &lt;- 32
glue("La edad es de {edad} a√±os")
```

```
&gt; La edad es de 32 a√±os
```

---

# Variables l√≥gicas

Una **variable l√≥gica, binaria o booleana** es aquella que **solo puede tomar dos valores (en realidad pueden tomar un tercer valor, ausente):

* `TRUE`, verdadero, guardado internamente como un 1.
* `FALSE`, verdadero, guardado internamente como un 1.


```r
soltero &lt;- TRUE # ¬øEs soltero? --&gt; S√ç
class(soltero)
```

```
&gt; [1] "logical"
```

&amp;nbsp;

**NO son variables de texto**: "TRUE" es un texto (como rojo o azul), `TRUE` es una valor l√≥gico.


```r
TRUE + 1
```

```
&gt; [1] 2
```

```r
"TRUE" + 1
```

```
&gt; Error in "TRUE" + 1: argumento no-num√©rico para operador binario
```

---

# Condiciones l√≥gicas

Los valores l√≥gicos suelen ser **resultado de evaluar condiciones l√≥gicas**. Por ejemplo, imaginemos que queremos comprobar si una persona est√° o no soltero, con el **operador l√≥gico** `==` (¬ølo de la izquierda es igual a lo de la derecha) y su opuesto `!=` (distinto de).


```r
soltero &lt;- TRUE # persona soltera
soltero == TRUE # ¬øest√° soltero?
```

```
&gt; [1] TRUE
```

```r
soltero != TRUE # ¬øno est√° soltero?
```

```
&gt; [1] FALSE
```


Por el mismo razonamiento podemos **comparar si una variable num√©rica** cumple una condici√≥n. ¬øTiene la persona menos de 32 a√±os? Adem√°s de las comparaciones ¬´igual a¬ª  frente ¬´distinto¬ª, tambi√©n comparaciones de orden como `&lt;, &lt;=, &gt; o &gt;=`.


```r
edad &lt;- 38
edad &lt; 32
```

```
&gt; [1] FALSE
```

---

# Combinar condiciones l√≥gicas

Las **condiciones l√≥gicas pueden ser combinadas**, principalmente de dos maneras:

* **Intersecci√≥n**: **todas** las condiciones concatenadas se deben cumplir (conjunci√≥n y, operador `&amp;`) para devolver un `TRUE`.

* **Uni√≥n**: basta con que **una** de las condiciones concatenadas se cumpla (conjunci√≥n o, operador `|`) para devolver un `TRUE`.

&amp;nbsp;

Ejemplo: podr√≠amos preguntarnos si la persona tiene menos de 32 a√±os y est√° soltero (AMBAS deben cumplirse).


```r
edad &lt; 32 &amp; soltero
```

```
&gt; [1] FALSE
```

El resultado es `FALSE` ya que solo se cumple una de las condiciones. Si nos bastase con una (¬´¬øest√° soltero y/o tiene menos de 32 a√±os?¬ª), el valor devuelto ser√≠a `TRUE`


```r
edad &lt; 32 | soltero
```

```
&gt; [1] TRUE
```

---

# Variables de tipo fecha

Las **variables de tipo fecha** son de un tipo muy especial: no son una simple cadena de texto "2021-04-21", representan un **instante temporal**.


```r
# Cadena de texto
fecha_char &lt;- "2021-04-21"
fecha_char + 1
```

```
&gt; Error in fecha_char + 1: argumento no-num√©rico para operador binario
```

Para **convertirlo a una fecha** podemos usar la funci√≥n `as.Date()` 


```r
fecha_date &lt;- as.Date("2021-04-21")
fecha_date 
```

```
&gt; [1] "2021-04-21"
```

```r
fecha_date + 1
```

```
&gt; [1] "2021-04-22"
```

Dado que internamente es un n√∫mero, **podemos restar fechas** (d√≠as entre ambas), podemos sumar n√∫meros a fechas (fecha d√≠as despu√©s), etc.


```r
as.Date("2021-04-21") - as.Date("2021-02-15")
```

```
&gt; Time difference of 65 days
```

---

# Funcionalidades de fechas

**¬øC√≥mo obtener autom√°ticamente la fecha de hoy?**


```r
Sys.Date()
```

```
&gt; [1] "2022-01-22"
```

&amp;nbsp;

**¬øC√≥mo convertir una cadena de texto a fecha?** Basta usar la funci√≥n `as.Date()`, pas√°ndole como argumento la fecha y su formato .


```r
as.Date("10-03-2020", "%d-%m-%Y") # con d√≠a-mes-a√±o (4 cifras)
```

```
&gt; [1] "2020-03-10"
```

```r
as.Date("10-03-20", "%d-%m-%y")  # con d√≠a-mes-a√±o (2 cifras)
```

```
&gt; [1] "2020-03-10"
```


Dentro del **paquete `{lubridate}` tenemos bastantes **funciones √∫tiles** para trabajar con fechas como las siguientes.

---

# Paquete lubridate



```r
install.packages("lubridate") # solo la primera vez
library(lubridate)
```




```r
today()
```

```
&gt; [1] "2022-01-22"
```

```r
fecha &lt;- now()
year(fecha)
```

```
&gt; [1] 2022
```

```r
month(fecha)
```

```
&gt; [1] 1
```

```r
fecha &gt; ymd(20170131)
```

```
&gt; [1] TRUE
```

---

# Tips

El **paquete `{stringr}`** permite un **manejo m√°s complejo de cadenas de texto** (como el uso de expresiones regulares).

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/stringr.png" alt = "stringr" align = "right" width = "900"&gt;

---

# Tips

Si haces click en la consola y pulsas la flecha ¬´arriba¬ª del teclado, te ir√° apareciendo todo el **historial de √≥rdenes ejecutadas**. Es una manera de ahorrar tiempo para ejecutar √≥rdenes similares a las ya ejecutadas. Si empiezas a escribir el nombre de una variable pero no te acuerdas exactamente de su nombre, pulsando tabulador te autocompletar√° solo.

&amp;nbsp;

Siempre que veas el s√≠mbolo `&gt;` como √∫ltima l√≠nea en la consola significa que est√° listo para que le escribamos otra orden.

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/tip_consola_lista.jpg" alt = "stringr" align = "right" width = "600"&gt;


---

# Ejercicios

.panelset[
.panel[.panel-name[Ejercicios]

* üìù **Ejercicio 1**: define una variable que guarde tu edad, otra con tu nombre, otra respondiendo a la pregunta ¬´¬øtengo hermanos?¬ª y otra con la fecha de tu nacimiento.
 

* üìù **Ejercicio 2**: define otra variable con tus apellidos y junta las variables nombre y apellidos en una sola variable `nombre_completo`.
 

* üìù **Ejercicio 4**: calcula los d√≠as que han pasado desde la fecha de tu nacimiento
 

* üìù **Ejercicio 5**: obt√©n una variable l√≥gica que nos diga si se cumplen (todas) las condiciones i) menor de 30 a√±os (`edad &lt; 30`); ii) con hermanos (`hermanos == TRUE`); iii) nacido en 1990 o posterior (`fecha_nacimiento &gt;= as.Date("1990-01-01")`).

* üìù **Ejercicio 6**: modifica el c√≥digo del ejercicio anterior para obtener una variable l√≥gica que nos diga si se cumplen (al menos) alguna de las condiciones i) menor de 30 a√±os; ii) con hermanos; iii) nacido en 1990 o posterior. Nos basta con que se cumple al menos una.
]

.panel[.panel-name[Soluci√≥n ej. 1]

```r
edad &lt;- 32 # tipo numeric
nombre &lt;- "Javier" # tipo caracter
hermanos &lt;- TRUE # tipo hermanos
fecha_nacimiento &lt;- as.Date("1989-09-10") # tipo fecha
```
]


.panel[.panel-name[Soluci√≥n ej. 2]


```r
# Nombre
nombre &lt;- "Javier"
# Apellidos
apellidos &lt;- "√Ålvarez Li√©bana"

# Pegamos
library(glue)
nombre_completo &lt;- glue("{nombre} {apellidos}")
nombre_completo
```

```
&gt; Javier √Ålvarez Li√©bana
```

```r
# Otra forma
nombre_completo &lt;- paste(nombre, apellidos)
nombre_completo
```

```
&gt; [1] "Javier √Ålvarez Li√©bana"
```
]

.panel[.panel-name[Soluci√≥n ej. 4]


```r
library(lubridate)
fecha_nacimiento &lt;- as.Date("1989-09-10")
days(today() - fecha_nacimiento)
```

```
&gt; [1] "11822d 0H 0M 0S"
```
]

.panel[.panel-name[Soluci√≥n ej. 5]


```r
# Se tienen que cumplir todas
edad &lt; 30 &amp; fecha_nacimiento &gt;= as.Date("1990-01-01") &amp; hermanos
```

```
&gt; [1] FALSE
```

```r
# otra forma
edad &lt; 30 &amp; fecha_nacimiento &gt;= as.Date("1990-01-01") &amp; hermanos == TRUE
```

```
&gt; [1] FALSE
```

]

.panel[.panel-name[Soluci√≥n ej. 6]


```r
# Se tienen que cumplir todas
edad &lt; 30 | fecha_nacimiento &gt;= as.Date("1990-01-01") | hermanos
```

```
&gt; [1] TRUE
```
]
]


---

name: vectores
class: center, middle

# Vectores


## **Variables: colecci√≥n de datos individuales de igual tipo**

&amp;nbsp;

¬øC√≥mo **concatenar** edades de varias personas? ¬øC√≥mo ordenarlas?

---

# Vectores: concatenar elementos

Los **vectores o arrays** no son m√°s que una **concatenaci√≥n de elementos del mismo tipo** (de hecho un n√∫mero individual `x &lt;- 1` es en realidad un vector de longitud uno).

Los crearemos con `c()` (c de concatenar), con sus **elementos entre par√©ntesis y separados por comas**. 


```r
edades &lt;- c(32, 27, 60, 61)
edades
```

```
&gt; [1] 32 27 60 61
```

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/vectores_enviroment.jpg" alt = "stringr" align = "right" width = "350"&gt;


La **longitud de un vector** se puede calcular con `length()`


```r
length(edades)
```

```
&gt; [1] 4
```

Dado que un n√∫mero y un vector es lo mismo (con distinta longitud), podemos **concatenar a vectores uno tras otro**.


```r
c(edades, edades, 8)
```

```
&gt; [1] 32 27 60 61 32 27 60 61  8
```


---

# Secuencias num√©ricas

Es habitual **crear vectores num√©ricos con un patr√≥n** repetido. Hay un **atajo**: `seq()` nos permite crear una **secuencia desde un elemento inicial hasta un elemento final**, avanzando de uno en uno.


```r
seq(1, 11) # secuencia desde 1 hasta 11 de 1 en 1 (equivalente: 1:11)
```

```
&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11
```

```r
11:1 # orden inverso
```

```
&gt;  [1] 11 10  9  8  7  6  5  4  3  2  1
```

Tambi√©n podemos definir **otro tipo de distancia entre dos elementos consecutivos**


```r
seq(1, 7, by = 0.5) # secuencia desde 1 a 7 de 0.5 en 0.5
```

```
&gt;  [1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5 7.0
```

Otras veces nos interesar√° definir una secuencia con un **n√∫mero concreto de elementos**.


```r
seq(1, 50, l = 7) # secuencia desde 1 a 50 de longitud 11
```

```
&gt; [1]  1.000000  9.166667 17.333333 25.500000 33.666667 41.833333 50.000000
```

---

# Secuencias num√©ricas

**Vectores repetidos**: otro atajo, para definir vectores de elementos repetidos, es la funci√≥n `rep()` nos permite repetir un elemento un n√∫mero fijado de veces.


```r
rep(0, 7) # vector de 7 ceros
```

```
&gt; [1] 0 0 0 0 0 0 0
```

No solo podemos repetir un n√∫mero sino que podemos **repetir vectores enteros**.


```r
rep(c(0, 1, 2), 4) # repetimos el vector c(0, 1, 2) 4 veces
```

```
&gt;  [1] 0 1 2 0 1 2 0 1 2 0 1 2
```

Esa repetici√≥n adem√°s podemos definirla tambi√©n de **forma intercalada**


```r
rep(c(0, 1, 2), each = 4) # cuatro 0, luego cuatro 1, luego cuatro 2
```

```
&gt;  [1] 0 0 0 0 1 1 1 1 2 2 2 2
```

---

# Vectores de texto


El concepto de vectores **no solo ata√±e a los n√∫meros**


```r
mi_nombre &lt;- c("Mi", "nombre", "es", "Javier")
mi_nombre
```

```
&gt; [1] "Mi"     "nombre" "es"     "Javier"
```

Cuando tenemos un vector de caracteres podemos colapsarlos con `paste()`, esta vez con `collapse = ...`


```r
paste(mi_nombre, collapse = ".") # separados por un punto .
```

```
&gt; [1] "Mi.nombre.es.Javier"
```

Podemos tambi√©n combinar vectores num√©ricos con caracteres.


```r
paste("persona", 1:5, sep = "_") # separado por una barra baja
```

```
&gt; [1] "persona_1" "persona_2" "persona_3" "persona_4" "persona_5"
```

---

# Vectores l√≥gicos

Los **vectores l√≥gicos** suelen aparecer de nuevo como la evaluaci√≥n de condiciones l√≥gicas.  Por ejemplo, si definimos el vector `x &lt;- c(1.5, -1, 2, 4, 3, -4)`, ¬øqu√© numeros de x son menores que 2?


```r
x &lt;- c(1.5, -1, 2, 4, 3, -4)
x &lt; 2 
```

```
&gt; [1]  TRUE  TRUE FALSE FALSE FALSE  TRUE
```

El primer, segundo y sexto elemento del vector son los √∫nicos elementos (estrictamente) menores que 2, de ah√≠ que en el primer, segundo y sexto elemento aparezca un TRUE y en el resto un FALSE.

&amp;nbsp;

Al igual que antes, las condiciones pueden ser **combinadas**


```r
x &lt;- c(1.5, -1, 2, 4, 3, -4)
x &lt; 3 &amp; x &gt; 0 # Solo los que cumplen ambas condiciones
```

```
&gt; [1]  TRUE FALSE  TRUE FALSE FALSE FALSE
```

---

# Datos ausentes

* **NA** (not available): valores que no tenemos (por ejemplo, el dato de contagios covid los fines de semana).


```r
x &lt;- c(1, NA, 3, NA, NA, 5, 6) # Vector num√©rico con datos faltante
x
```

```
&gt; [1]  1 NA  3 NA NA  5  6
```

```r
2 * x
```

```
&gt; [1]  2 NA  6 NA NA 10 12
```

--

* **NaN** (not a number): resultado no permitido


```r
sqrt(-1)
```

```
&gt; [1] NaN
```


```r
x &lt;- c(1, NA, 3, 4, 6, 7, NaN, NA)
is.na(x)
```

```
&gt; [1] FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE  TRUE
```

---

# Operaciones aritm√©ticas con vectores

Toda **operaci√≥n aritm√©tica** que podamos hacer con un n√∫mero la vamos a poder a hacer con un vector de n√∫meros: la operaci√≥n se realizar√° en **CADA ELEMENTO** del vector (en otros lenguajes no siempre es as√≠).


```r
# Multiplicamos por 2 a CADA ELEMENTO del vector
z &lt;- c(2, 4, 6)
2 * z
```

```
&gt; [1]  4  8 12
```

De la misma manera se pueden definir **sumas** de vectores.


```r
x &lt;- c(1, 3, 5)
x + z
```

```
&gt; [1]  3  7 11
```

--

Dado que los valores l√≥gicos son guardados internamente como `0/1`  podemos usar operaciones aritm√©ticas con ellos.


```r
x &lt;- c(1, 3, 5)
sum(x &lt; 2) # sumamos el vector l√≥gico --&gt; n√∫mero de valores TRUE
```

```
&gt; [1] 1
```

---

# Operaciones estad√≠sticas con vectores
 
Tambi√©n podemos realizar **operaciones estad√≠sticas** como la suma, la media o la mediana.


```r
y &lt;- c(1, -4, 5, 0, 7)
sum(y)  # suma
```

```
&gt; [1] 9
```

```r
mean(y) # media
```

```
&gt; [1] 1.8
```

**IMPORTANTE**: las operaciones con ausentes no funcionan (salvo que los eliminemos antes con `na.rm = TRUE`).


```r
y &lt;- c(1, 2, NA, -5, 0)
sum(y)
```

```
&gt; [1] NA
```

```r
sum(y, na.rm = TRUE)
```

```
&gt; [1] -2
```


---

# Seleccionar elementos

¬øY si del vector original queremos **EXTRAER UN SUBCONJUNTO**? La forma m√°s sencilla es **acceder al elemento i-√©simo** con el operador de selecci√≥n `[i]`, o en base a una **condici√≥n l√≥gica**




```r
edades &lt;- c(20, 30, 32, NA, 61)
edades[3] # accedemos a la edad de la tercera persona
```

```
&gt; [1] 32
```

```r
*edades[c(3, 4)]
```

```
&gt; [1] 32 NA
```

```r
edades[edades &gt; 30]
```

```
&gt; [1] 32 NA 61
```

Otras veces no querremos seleccionar un elemento sino **filtrarlo**, con el operador `[-i]`


```r
edades[-1]
```

```
&gt; [1] 30 32 NA 61
```




---

# Nombrando vectores


`R` nos permite dar **significado l√©xico a nuestros datos**, pudiendo poner **nombres a los elementos** de un vector.


```r
x &lt;- c("edad" = 31, "tlf" = 613910687, "cp" = 33007) # cada n√∫mero tiene un significado distinto
x
```

```
&gt;      edad       tlf        cp 
&gt;        31 613910687     33007
```

Esto es una ventaja ya que nos permite su **selecci√≥n usando dichos nombres**: los n√∫meros ya representan algo.


```r
x[c("edad", "cp")] # seleccionamos los elementos que tienen ese nombre asignado
```

```
&gt;  edad    cp 
&gt;    31 33007
```

Con la funci√≥n `names()` podemos, no solo consultar sino cambiar los nombres.


```r
names(x) # Consultamos nombres antiguos
```

```
&gt; [1] "edad" "tlf"  "cp"
```

```r
names(x) &lt;- c("a√±os", "m√≥vil", "direcci√≥n") # Cambiamos nombres
```

---

# Ordenar vectores

Una acci√≥n **muy habitual** es **ordenar los datos**: de menor a mayor edad, datos m√°s recientes vs antiguos, etc. Para ello tenemos la funci√≥n `sort()`: vamos a ordenar, por ejemplo, una colecci√≥n de edades.


```r
edades &lt;- c(81, 7, 25, 41, 65, 20, 32, 23, 77)
sort(edades) # orden de joven a mayor
```

```
&gt; [1]  7 20 23 25 32 41 65 77 81
```

Por defecto `sort()` ordena de menor a mayor: con `decreasing = TRUE` podemos ordenar de mayor a menor.


```r
sort(edades, decreasing = TRUE) 
```

```
&gt; [1] 81 77 65 41 32 25 23 20  7
```

Otra forma de ordenar un vector es **pedirle nos devuelva los √≠ndices de los elementos ordenados** con `order`, y luego usar dichos √≠ndices.


```r
x &lt;- c(7, 1, 2, 6)
x[order(x)]
```

```
&gt; [1] 1 2 6 7
```

---

# Ejercicios con vectores

.panelset[
.panel[.panel-name[Ejercicios]

* üìù **Ejercicio 1**: modifica el c√≥digo para crear un vector de nombre `vector_num` que contenga los n√∫meros 1, 5 y -7.


```r
# Vector de n√∫meros
vector_num &lt;- c(1)
```

* üìù **Ejercicio 2**: define un vector que contenga los n√∫meros `1, 10, -1 y 2`, y obt√©n la longitud del vector anterior vector_num.
 

* üìù **Ejercicio 4**: crea un vector con las palabras ‚ÄúHola‚Äù, ‚Äúme‚Äù, ‚Äúllamo‚Äù (y tu nombre y apellidos), y pega luego sus elementos de forma que la frase est√© correctamente escrita en castellano. Tras hacerlo, a√±ade ‚Äúy tengo 30 a√±os‚Äù.
 
 
* üìù **Ejercicio 7**: crea una secuencia que empiece en 1 y recorra todos los naturales hasta el 10. Despu√©s crea otra secuencia de longitud 7 que todos los n√∫meros sean 3.
 

* üìù **Ejercicio 9**: crea un vector con las edades de cuatro conocidos o familiares. Tras ello, determina cu√°les de ellos tienen menos de 20 a√±os, 30 a√±os o m√°s, menos de 40 a√±os y m√°s de 65 a√±os.

]

.panel[.panel-name[Soluci√≥n ej. 1]


```r
# Vector de n√∫meros
vector_num &lt;- c(1, 5, -7)
vector_num
```

```
&gt; [1]  1  5 -7
```
]

.panel[.panel-name[Soluci√≥n ej. 2]


```r
# Vector de n√∫meros
vector_num &lt;- c(1, 10, -1, 2)
vector_num
```

```
&gt; [1]  1 10 -1  2
```
]

.panel[.panel-name[Soluci√≥n ej. 4]


```r
# Definiendo el vector
vector_char &lt;- c("Hola", "me", "llamo", "Javier",
                 "√Ålvarez", "Li√©bana")

# Pegamos
frase &lt;- paste(vector_char, collapse = " ")
frase
```

```
&gt; [1] "Hola me llamo Javier √Ålvarez Li√©bana"
```

```r
# A√±adimos frase
glue("{frase} y tengo 30 a√±os.")
```

```
&gt; Hola me llamo Javier √Ålvarez Li√©bana y tengo 30 a√±os.
```
]

.panel[.panel-name[Soluci√≥n ej. 7]


```r
1:10
```

```
&gt;  [1]  1  2  3  4  5  6  7  8  9 10
```

```r
rep(3, 7) # secuencia repetida de treses
```

```
&gt; [1] 3 3 3 3 3 3 3
```
]

.panel[.panel-name[Soluci√≥n ej. 9]


```r
edades &lt;- c(27, 32, 60, 61) # en mi caso, por ejemplo
edades &lt; 20 # menos de 20 a√±os
```

```
&gt; [1] FALSE FALSE FALSE FALSE
```

```r
edades &gt;= 30 # 30 a√±os o m√°s
```

```
&gt; [1] FALSE  TRUE  TRUE  TRUE
```

```r
edades &lt; 40 # menos de 40 a√±os
```

```
&gt; [1]  TRUE  TRUE FALSE FALSE
```
]
]



---

name: matrices-datafroames
class: center, middle



# Datos estructurados: colecci√≥n de variables


## **matrices: igual tipo y longitud**

&amp;nbsp;

## **data.frame o tabla: distinto tipo pero igual longitud**

---

# Datos estructurados: colecci√≥n de variables


&lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/celdas.jpg" alt = "celdas" align = "center" width = "580" style = "margin-top: 1vh;"&gt;

Ya sabemos:

‚úÖ Los **tipos de datos** que puede contener una **celda**.

‚úÖ Como **concatenar celdas** obteniendo variables (vectores, datos del mismo tipo).

Lo que haremos a continuaci√≥n ser√° **juntar esas variables**: bien del **mismo tipo** (matrices), bien de **distinto tipo** (`data.frame`), en cualquier caso de **igual longitud**.

---

# Matrices: variables del mismo tipo

Cuando analizamos datos solemos tener **varias variables distintas de cada individuo**. Necesitamos una ¬´tabla¬ª que una distintas variables (de IGUAL longitud). Las **matrices** son una **concatenaci√≥n de variables, del mismo tipo e igual longitud**, dispuestas en columnas (normalmente cada fila representa un individuo y cada columna una variable). La concatenaci√≥n en columnas la haremos con `cbind()`.


```r
estaturas &lt;- c(150, 160, 170, 180)
pesos &lt;- c(60, 70, 80, 90)
datos_matriz &lt;- cbind(estaturas, pesos) # Construimos la matriz por columnas
datos_matriz # nuestra primera matriz
```

```
&gt;      estaturas pesos
&gt; [1,]       150    60
&gt; [2,]       160    70
&gt; [3,]       170    80
&gt; [4,]       180    90
```


| estaturas| pesos|
|---------:|-----:|
|       150|    60|
|       160|    70|
|       170|    80|
|       180|    90|

---

# Matrices


Tambi√©n podemos **construir la matriz por filas** con `rbind()`, que nos permite **a√±adir filas a una matriz o construirla desde cero** (aunque lo habitual es tener cada variable en una columna y cada individuo en una fila).


```r
rbind(estaturas, pesos) # Construimos la matriz por filas
```

```
&gt;           [,1] [,2] [,3] [,4]
&gt; estaturas  150  160  170  180
&gt; pesos       60   70   80   90
```


|          |    |    |    |    |
|:---------|---:|---:|---:|---:|
|estaturas | 150| 160| 170| 180|
|pesos     |  60|  70|  80|  90|

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/datos_matriz_1.jpg" alt = "course-ECI" align = "right" width = "400" style = "margin-top: 3vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

--

Podemos **visualizar la matriz** en un formato ¬´excelizado¬ª con la funci√≥n `View()`


```r
View(datos_matriz)
```

---

# Matrices

.panelset[
.panel[.panel-name[Ejemplo] 

Veamos un ejemplo m√°s jugoso para practicar: una matriz con las edades, tel√©fonos y c√≥digos postales.



```r
edades &lt;- c(14, 56, 31, 20, 68) # vector num√©rico de longitud 4
tlf &lt;- c(NA, 683839390, 621539732, NA, NA)
cp &lt;- c(33007, 28019, 37005, 18003, 28045)

# Construimos la matriz por columnas
datos_matriz &lt;- cbind(edades, tlf, cp) 
datos_matriz
```

```
&gt;      edades       tlf    cp
&gt; [1,]     14        NA 33007
&gt; [2,]     56 683839390 28019
&gt; [3,]     31 621539732 37005
&gt; [4,]     20        NA 18003
&gt; [5,]     68        NA 28045
```
]

.panel[.panel-name[A√±adir columna] 

Con `cbind()` tambi√©n podemos **a√±adir una columna**


```r
cbind(datos_matriz, "estaturas" = c(160, NA, 181, 165, 173))
```

```
&gt;      edades       tlf    cp estaturas
&gt; [1,]     14        NA 33007       160
&gt; [2,]     56 683839390 28019        NA
&gt; [3,]     31 621539732 37005       181
&gt; [4,]     20        NA 18003       165
&gt; [5,]     68        NA 28045       173
```
]

.panel[.panel-name[Dimensiones] 
Y podemos **ver sus dimensiones** con `dim()`, o por separado con `nrow()` y `ncol()`


```r
dim(datos_matriz)
```

```
&gt; [1] 5 3
```

```r
c(nrow(datos_matriz), ncol(datos_matriz))
```

```
&gt; [1] 5 3
```

Dada una matriz tambi√©n podemos **¬´darle vuelta¬ª** (lo que se conoce como **matriz transpuesta**) con `t()`.


```r
t(datos_matriz)
```

```
&gt;         [,1]      [,2]      [,3]  [,4]  [,5]
&gt; edades    14        56        31    20    68
&gt; tlf       NA 683839390 621539732    NA    NA
&gt; cp     33007     28019     37005 18003 28045
```

]

.panel[.panel-name[matrix()] 

Igual que a veces es √∫til generar un vector de elementos repetidos, tambi√©n podemos definir una **matriz de n√∫meros repetidos** (por ejemplo, de ceros), con la funci√≥n `matrix()`, indic√°ndole el n√∫mero de filas y columnas.


```r
matrix(0, nrow = 4, ncol = 2) # 4 filas, 2 columnas, todo 0's
```

```
&gt;      [,1] [,2]
&gt; [1,]    0    0
&gt; [2,]    0    0
&gt; [3,]    0    0
&gt; [4,]    0    0
```

Tambi√©n podemos **definir una matriz a partir de un vector num√©rico**, reorganizando los valores en forma de matriz, sabiendo que los elementos se van colocando por columnas.


```r
z &lt;- matrix(1:15, ncol = 5) # Matriz con el vector 1:5 con 5 columnas (ergo 3 filas)
z
```

```
&gt;      [,1] [,2] [,3] [,4] [,5]
&gt; [1,]    1    4    7   10   13
&gt; [2,]    2    5    8   11   14
&gt; [3,]    3    6    9   12   15
```

]

.panel[.panel-name[Operaciones] 

Con las matrices sucede como con los vectores: cuando **aplicamos una operaci√≥n aritm√©tica se la estamos aplicando elemento a elemento**, por ejemplo, dividir entre 5 o sumar una constante


```r
datos_matriz / 5
```

```
&gt;      edades       tlf     cp
&gt; [1,]    2.8        NA 6601.4
&gt; [2,]   11.2 136767878 5603.8
&gt; [3,]    6.2 124307946 7401.0
&gt; [4,]    4.0        NA 3600.6
&gt; [5,]   13.6        NA 5609.0
```

```r
datos_matriz + 3
```

```
&gt;      edades       tlf    cp
&gt; [1,]     17        NA 33010
&gt; [2,]     59 683839393 28022
&gt; [3,]     34 621539735 37008
&gt; [4,]     23        NA 18006
&gt; [5,]     71        NA 28048
```
]

.panel[.panel-name[Otras matrices] 

Tambi√©n podemos **crear matrices de otros tipos de datos**, siempre y cuando las columnas sean del mismo tipo e igual longitud.


```r
nombres &lt;- c("Javier", "Carlos", "Mar√≠a", "Paloma")
apellidos &lt;- c("√Ålvarez", "Garc√≠a", "P√©rez", "Li√©bana")
cbind(nombres, apellidos)
```

```
&gt;      nombres  apellidos
&gt; [1,] "Javier" "√Ålvarez"
&gt; [2,] "Carlos" "Garc√≠a" 
&gt; [3,] "Mar√≠a"  "P√©rez"  
&gt; [4,] "Paloma" "Li√©bana"
```

]
]

---

# Matrices

Las matrices son objetos **bidimensionales**: para acceder a la **fila i-√©sima** se usa el operador `[i, ]` (dejando el otro sin rellenar), para acceder a la **columna j-√©sima** se usa el operador `[, j]`. Para acceder **conjuntamente al elemento (i, j)** se  `[i, j]`. Tambi√©n podemos **acceder por nombres de las columnas**.



```r
datos_matriz[2, 3]
```

```
&gt;    cp 
&gt; 28019
```

```r
datos_matriz[1, ] # fila 1
```

```
&gt; edades    tlf     cp 
&gt;     14     NA  33007
```

```r
datos_matriz[, 3] # columna 3
```

```
&gt; [1] 33007 28019 37005 18003 28045
```

```r
datos_matriz[1, c("edades", "tlf")] # por nombres
```

```
&gt; edades    tlf 
&gt;     14     NA
```

---

# Operaciones por filas y columnas (apply)

Imagina que tuvi√©semos nuestra matriz de estaturas y pesos.


```r
datos_matriz &lt;- cbind(estaturas, pesos)
datos_matriz
```

```
&gt;      estaturas pesos
&gt; [1,]       150    60
&gt; [2,]       160    70
&gt; [3,]       170    80
&gt; [4,]       180    90
```

¬øC√≥mo podemos **obtener la media de cada columna**? Con la funci√≥n `apply()` le indicaremos

* la matriz
* el sentido de la operaci√≥n (`MARGIN = 1` por filas, `MARGIN = 2` por columnas)
* la funci√≥n a aplicar (en este caso, `mean`).


```r
# Media por columnas (MARGIN = 2)
apply(datos_matriz, MARGIN = 2, FUN = "mean")
```

```
&gt; estaturas     pesos 
&gt;       165        75
```

---

# Ejercicios

.panelset[
.panel[.panel-name[Ejercicios]


* üìù **Ejercicio 1**: modifica el c√≥digo para definir una matriz x de ceros de 3 filas y 7 columnas.
 

```r
# Matriz
x &lt;- matrix(0, nrow = 2, ncol = 3)
x
```

* üìù **Ejercicio 2**: a la matriz anterior, suma un 1 a cada n√∫mero de la matriz y divide el resultado entre 5.
 
 
* üìù **Ejercicio 4**: el siguiente c√≥digo define una matriz de dimensiones `4 x 3` y calcula la suma por columnas. Modifica el c√≥digo para que realice la suma por filas.
 

```r
# Matriz
matriz &lt;- matrix(1:12, nrow = 4)

# Suma por columnas
apply(matriz, MARGIN = 2, FUN = "sum")
```


* üìù **Ejercicio 5**: con la matriz anterior definida como `matrix(1:12, nrow = 4)`, calcula la media de todos los elementos, la media de cada fila y la media de cada columna.
]

.panel[.panel-name[Soluci√≥n Ej. 1]


```r
# Matriz
x &lt;- matrix(0, nrow = 3, ncol = 7)
x
```

```
&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
&gt; [1,]    0    0    0    0    0    0    0
&gt; [2,]    0    0    0    0    0    0    0
&gt; [3,]    0    0    0    0    0    0    0
```

]

.panel[.panel-name[Soluci√≥n Ej. 2]


```r
(x + 1) / 5
```

```
&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
&gt; [1,]  0.2  0.2  0.2  0.2  0.2  0.2  0.2
&gt; [2,]  0.2  0.2  0.2  0.2  0.2  0.2  0.2
&gt; [3,]  0.2  0.2  0.2  0.2  0.2  0.2  0.2
```

]

.panel[.panel-name[Soluci√≥n Ej. 4]


```r
# Matriz
matriz &lt;- matrix(1:12, nrow = 4)

# Suma por filas
apply(matriz, MARGIN = 1, FUN = "sum")
```

```
&gt; [1] 15 18 21 24
```

]

.panel[.panel-name[Soluci√≥n Ej. 5]


```r
# Matriz
matriz &lt;- matrix(1:12, nrow = 4)

#  media de todos
mean(matriz)
```

```
&gt; [1] 6.5
```

```r
# Media por filas (MARGIN = 1 ya que es una operaci√≥n por filas)
apply(matriz, MARGIN = 1, FUN = "mean")
```

```
&gt; [1] 5 6 7 8
```

```r
# Media por filas (MARGIN = 2 ya que es una operaci√≥n por filas)
apply(matriz, MARGIN = 2, FUN = "mean")
```

```
&gt; [1]  2.5  6.5 10.5
```

]
]
 
---

# data.frame: tablas

**¬øQu√© sucede si a√±adimos una columna con los nombres de cada persona en nuestra matriz `datos_matriz`?** En dicha matriz ten√≠amos guardadas las edades, c√≥digos postales y tel√©fonos de una serie de personas, todas ellas variables num√©ricas.


```r
nombres &lt;- c("Sonia", "Carla", "Pepito", "Carlos")
datos_matriz_nueva &lt;- cbind(nombres, datos_matriz)
datos_matriz_nueva
```

```
&gt;      nombres  estaturas pesos
&gt; [1,] "Sonia"  "150"     "60" 
&gt; [2,] "Carla"  "160"     "70" 
&gt; [3,] "Pepito" "170"     "80" 
&gt; [4,] "Carlos" "180"     "90"
```

Como una **matriz SOLO puede tener un tipo de dato**, al a√±adir una variable de tipo texto, `R` se ha visto obligado a convertir los n√∫meros en texto: hemos **roto la integridad** de los datos.


```r
datos_matriz_nueva[, "pesos"] + 1
```

```
&gt; Error in datos_matriz_nueva[, "pesos"] + 1: argumento no-num√©rico para operador binario
```


---

# data.frame: tablas

El formato de tabla de datos en `R` que vamos a empezar a usar se llama `data.frame`, y no es m√°s que una **colecci√≥n de variables de igual longitud pero cada una puede ser de un tipo distinto**. Para crear un `data.frame` basta con usar la funci√≥n `data.frame()`.


```r
# Nombres
nombres &lt;- c("Sonia", "Carla", "Pepito", "Carlos")
# Edades
edades &lt;- c(45, 67, NA, 31)
# Estado civil (no lo sabemos de una persona)
casado &lt;- c(TRUE, FALSE, FALSE, NA)
# Fecha de creaci√≥n (fecha en el que esa persona entra en el sistema)
# lo convertimos a tipo fecha
f_creacion &lt;-
  as.Date(c("2021-03-04", "2020-10-12", "1990-04-05", "2019-09-10"))

# Creamos nuestro primer data.frame
tabla &lt;- data.frame(nombres, edades, casado, f_creacion)
tabla
```

```
&gt;   nombres edades casado f_creacion
&gt; 1   Sonia     45   TRUE 2021-03-04
&gt; 2   Carla     67  FALSE 2020-10-12
&gt; 3  Pepito     NA  FALSE 1990-04-05
&gt; 4  Carlos     31     NA 2019-09-10
```

---

# data.frame: tablas

Al igual que con las matrices, podemos **crearlos** indicando adem√°s el **nombre de las columnas**.


```r
tabla &lt;- data.frame("nombre" = nombres, "edad" = edades,
                    "casado" = casado, "fecha_registro" = f_creacion)
```


Si tenemos un `data.frame` ya creado podemos usar `data.frame()` tambi√©n para a√±adir una columna.


```r
# A√±adimos una nueva columna con n¬∫ de hermanos/as
tabla &lt;- data.frame(tabla, "n_hermanos" = c(0, 0, 1, 5))
```

Con `View()` podemos **visualizar nuestra tabla**.


|nombre | edad|casado |fecha_registro | n_hermanos|
|:------|----:|:------|:--------------|----------:|
|Sonia  |   45|TRUE   |2021-03-04     |          0|
|Carla  |   67|FALSE  |2020-10-12     |          0|
|Pepito |   NA|FALSE  |1990-04-05     |          1|
|Carlos |   31|NA     |2019-09-10     |          5|

---

# Selecci√≥n de columnas y filas

Si queremos **acceder a una columna, fila o elemento** en concreto, los `data.frame` tienen las mismas ventajas que una matriz, as√≠ que bastar√≠a con usar los mismos operadores.


```r
tabla[, 3] # Accedemos a la tercera columna
```

```
&gt; [1]  TRUE FALSE FALSE    NA
```

```r
tabla[4, ] # Accedemos a la cuarta fila
```

```
&gt;   nombre edad casado fecha_registro n_hermanos
&gt; 4 Carlos   31     NA     2019-09-10          5
```

No solo tiene las ventajas de una matriz si no que tambi√©n tiene las ventajas de una **¬´base¬ª de datos**: podemos **aceder a las variables** por su nombre poniendo el nombre de la tabla m√°s el s√≠mbolo `$` y, con el tabulador, nos aparecer√° un **men√∫ de columnas** a elegir.

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/tabla_dolar.jpg" alt = "course-ECI" align = "right" width = "450" style = "margin-top: 3vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

---

# Ejercicios


.panelset[
.panel[.panel-name[Ejercicios]


* üìù **Ejercicio 6**: el `data.frame` llamado `airquality`, del paquete `{datasets}`, contiene variables de la calidad del aire de la ciudad de Nueva York desde mayo hasta septiembre de 1973. Obt√©n el nombre de las variables.
 

* üìù **Ejercicio 7**: obt√©n las dimensiones del anterior conjunto de datos. ¬øCu√°ntas variables hay? ¬øCu√°ntos d√≠as se han medido?
 

* üìù **Ejercicio 8**: filtra del conjunto anterior solo los datos del mes de julio.

* üìù **Ejercicio 10**: q√∫edate solo con las variable Ozone y Temp.
 
* üìù **Ejercicio 13**: a√±ade a los datos originales una columna con la fecha completa (recuerda que es del a√±o 1973 todas las observaciones.

]

.panel[.panel-name[Soluci√≥n Ej. 6]


```r
# install.packages("datasets") si no estuviera ya instalado
library(datasets)
names(airquality)
```

```
&gt; [1] "Ozone"   "Solar.R" "Wind"    "Temp"    "Month"   "Day"
```

]

.panel[.panel-name[Soluci√≥n Ej. 7]


```r
# Dimensiones
dim(airquality)
```

```
&gt; [1] 153   6
```

```r
nrow(airquality)
```

```
&gt; [1] 153
```

```r
ncol(airquality)
```

```
&gt; [1] 6
```

]

.panel[.panel-name[Soluci√≥n Ej. 8]


```r
filtro_filas &lt;- airquality[airquality$Month == 7, ]
filtro_filas
```

```
&gt;    Ozone Solar.R Wind Temp Month Day
&gt; 62   135     269  4.1   84     7   1
&gt; 63    49     248  9.2   85     7   2
&gt; 64    32     236  9.2   81     7   3
&gt; 65    NA     101 10.9   84     7   4
&gt; 66    64     175  4.6   83     7   5
&gt; 67    40     314 10.9   83     7   6
&gt; 68    77     276  5.1   88     7   7
&gt; 69    97     267  6.3   92     7   8
&gt; 70    97     272  5.7   92     7   9
&gt; 71    85     175  7.4   89     7  10
&gt; 72    NA     139  8.6   82     7  11
&gt; 73    10     264 14.3   73     7  12
&gt; 74    27     175 14.9   81     7  13
&gt; 75    NA     291 14.9   91     7  14
&gt; 76     7      48 14.3   80     7  15
&gt; 77    48     260  6.9   81     7  16
&gt; 78    35     274 10.3   82     7  17
&gt; 79    61     285  6.3   84     7  18
&gt; 80    79     187  5.1   87     7  19
&gt; 81    63     220 11.5   85     7  20
&gt; 82    16       7  6.9   74     7  21
&gt; 83    NA     258  9.7   81     7  22
&gt; 84    NA     295 11.5   82     7  23
&gt; 85    80     294  8.6   86     7  24
&gt; 86   108     223  8.0   85     7  25
&gt; 87    20      81  8.6   82     7  26
&gt; 88    52      82 12.0   86     7  27
&gt; 89    82     213  7.4   88     7  28
&gt; 90    50     275  7.4   86     7  29
&gt; 91    64     253  7.4   83     7  30
&gt; 92    59     254  9.2   81     7  31
```

]

.panel[.panel-name[Soluci√≥n Ej. 10]


```r
# Filtramos columnas
filtro_cols &lt;- airquality[, c("Ozone", "Temp")]
filtro_cols
```

```
&gt;     Ozone Temp
&gt; 1      41   67
&gt; 2      36   72
&gt; 3      12   74
&gt; 4      18   62
&gt; 5      NA   56
&gt; 6      28   66
&gt; 7      23   65
&gt; 8      19   59
&gt; 9       8   61
&gt; 10     NA   69
&gt; 11      7   74
&gt; 12     16   69
&gt; 13     11   66
&gt; 14     14   68
&gt; 15     18   58
&gt; 16     14   64
&gt; 17     34   66
&gt; 18      6   57
&gt; 19     30   68
&gt; 20     11   62
&gt; 21      1   59
&gt; 22     11   73
&gt; 23      4   61
&gt; 24     32   61
&gt; 25     NA   57
&gt; 26     NA   58
&gt; 27     NA   57
&gt; 28     23   67
&gt; 29     45   81
&gt; 30    115   79
&gt; 31     37   76
&gt; 32     NA   78
&gt; 33     NA   74
&gt; 34     NA   67
&gt; 35     NA   84
&gt; 36     NA   85
&gt; 37     NA   79
&gt; 38     29   82
&gt; 39     NA   87
&gt; 40     71   90
&gt; 41     39   87
&gt; 42     NA   93
&gt; 43     NA   92
&gt; 44     23   82
&gt; 45     NA   80
&gt; 46     NA   79
&gt; 47     21   77
&gt; 48     37   72
&gt; 49     20   65
&gt; 50     12   73
&gt; 51     13   76
&gt; 52     NA   77
&gt; 53     NA   76
&gt; 54     NA   76
&gt; 55     NA   76
&gt; 56     NA   75
&gt; 57     NA   78
&gt; 58     NA   73
&gt; 59     NA   80
&gt; 60     NA   77
&gt; 61     NA   83
&gt; 62    135   84
&gt; 63     49   85
&gt; 64     32   81
&gt; 65     NA   84
&gt; 66     64   83
&gt; 67     40   83
&gt; 68     77   88
&gt; 69     97   92
&gt; 70     97   92
&gt; 71     85   89
&gt; 72     NA   82
&gt; 73     10   73
&gt; 74     27   81
&gt; 75     NA   91
&gt; 76      7   80
&gt; 77     48   81
&gt; 78     35   82
&gt; 79     61   84
&gt; 80     79   87
&gt; 81     63   85
&gt; 82     16   74
&gt; 83     NA   81
&gt; 84     NA   82
&gt; 85     80   86
&gt; 86    108   85
&gt; 87     20   82
&gt; 88     52   86
&gt; 89     82   88
&gt; 90     50   86
&gt; 91     64   83
&gt; 92     59   81
&gt; 93     39   81
&gt; 94      9   81
&gt; 95     16   82
&gt; 96     78   86
&gt; 97     35   85
&gt; 98     66   87
&gt; 99    122   89
&gt; 100    89   90
&gt; 101   110   90
&gt; 102    NA   92
&gt; 103    NA   86
&gt; 104    44   86
&gt; 105    28   82
&gt; 106    65   80
&gt; 107    NA   79
&gt; 108    22   77
&gt; 109    59   79
&gt; 110    23   76
&gt; 111    31   78
&gt; 112    44   78
&gt; 113    21   77
&gt; 114     9   72
&gt; 115    NA   75
&gt; 116    45   79
&gt; 117   168   81
&gt; 118    73   86
&gt; 119    NA   88
&gt; 120    76   97
&gt; 121   118   94
&gt; 122    84   96
&gt; 123    85   94
&gt; 124    96   91
&gt; 125    78   92
&gt; 126    73   93
&gt; 127    91   93
&gt; 128    47   87
&gt; 129    32   84
&gt; 130    20   80
&gt; 131    23   78
&gt; 132    21   75
&gt; 133    24   73
&gt; 134    44   81
&gt; 135    21   76
&gt; 136    28   77
&gt; 137     9   71
&gt; 138    13   71
&gt; 139    46   78
&gt; 140    18   67
&gt; 141    13   76
&gt; 142    24   68
&gt; 143    16   82
&gt; 144    13   64
&gt; 145    23   71
&gt; 146    36   81
&gt; 147     7   69
&gt; 148    14   63
&gt; 149    30   70
&gt; 150    NA   77
&gt; 151    14   75
&gt; 152    18   76
&gt; 153    20   68
```

]

.panel[.panel-name[Soluci√≥n Ej. 13]


```r
# Construimos las fechas (pegamos a√±o-mes-d√≠a con "-")
fechas &lt;- 
  as.Date(paste("1973", airquality$Month, airquality$Day,
                sep = "-"))

# A√±adimos
data.frame(airquality, fechas)
```

```
&gt;     Ozone Solar.R Wind Temp Month Day     fechas
&gt; 1      41     190  7.4   67     5   1 1973-05-01
&gt; 2      36     118  8.0   72     5   2 1973-05-02
&gt; 3      12     149 12.6   74     5   3 1973-05-03
&gt; 4      18     313 11.5   62     5   4 1973-05-04
&gt; 5      NA      NA 14.3   56     5   5 1973-05-05
&gt; 6      28      NA 14.9   66     5   6 1973-05-06
&gt; 7      23     299  8.6   65     5   7 1973-05-07
&gt; 8      19      99 13.8   59     5   8 1973-05-08
&gt; 9       8      19 20.1   61     5   9 1973-05-09
&gt; 10     NA     194  8.6   69     5  10 1973-05-10
&gt; 11      7      NA  6.9   74     5  11 1973-05-11
&gt; 12     16     256  9.7   69     5  12 1973-05-12
&gt; 13     11     290  9.2   66     5  13 1973-05-13
&gt; 14     14     274 10.9   68     5  14 1973-05-14
&gt; 15     18      65 13.2   58     5  15 1973-05-15
&gt; 16     14     334 11.5   64     5  16 1973-05-16
&gt; 17     34     307 12.0   66     5  17 1973-05-17
&gt; 18      6      78 18.4   57     5  18 1973-05-18
&gt; 19     30     322 11.5   68     5  19 1973-05-19
&gt; 20     11      44  9.7   62     5  20 1973-05-20
&gt; 21      1       8  9.7   59     5  21 1973-05-21
&gt; 22     11     320 16.6   73     5  22 1973-05-22
&gt; 23      4      25  9.7   61     5  23 1973-05-23
&gt; 24     32      92 12.0   61     5  24 1973-05-24
&gt; 25     NA      66 16.6   57     5  25 1973-05-25
&gt; 26     NA     266 14.9   58     5  26 1973-05-26
&gt; 27     NA      NA  8.0   57     5  27 1973-05-27
&gt; 28     23      13 12.0   67     5  28 1973-05-28
&gt; 29     45     252 14.9   81     5  29 1973-05-29
&gt; 30    115     223  5.7   79     5  30 1973-05-30
&gt; 31     37     279  7.4   76     5  31 1973-05-31
&gt; 32     NA     286  8.6   78     6   1 1973-06-01
&gt; 33     NA     287  9.7   74     6   2 1973-06-02
&gt; 34     NA     242 16.1   67     6   3 1973-06-03
&gt; 35     NA     186  9.2   84     6   4 1973-06-04
&gt; 36     NA     220  8.6   85     6   5 1973-06-05
&gt; 37     NA     264 14.3   79     6   6 1973-06-06
&gt; 38     29     127  9.7   82     6   7 1973-06-07
&gt; 39     NA     273  6.9   87     6   8 1973-06-08
&gt; 40     71     291 13.8   90     6   9 1973-06-09
&gt; 41     39     323 11.5   87     6  10 1973-06-10
&gt; 42     NA     259 10.9   93     6  11 1973-06-11
&gt; 43     NA     250  9.2   92     6  12 1973-06-12
&gt; 44     23     148  8.0   82     6  13 1973-06-13
&gt; 45     NA     332 13.8   80     6  14 1973-06-14
&gt; 46     NA     322 11.5   79     6  15 1973-06-15
&gt; 47     21     191 14.9   77     6  16 1973-06-16
&gt; 48     37     284 20.7   72     6  17 1973-06-17
&gt; 49     20      37  9.2   65     6  18 1973-06-18
&gt; 50     12     120 11.5   73     6  19 1973-06-19
&gt; 51     13     137 10.3   76     6  20 1973-06-20
&gt; 52     NA     150  6.3   77     6  21 1973-06-21
&gt; 53     NA      59  1.7   76     6  22 1973-06-22
&gt; 54     NA      91  4.6   76     6  23 1973-06-23
&gt; 55     NA     250  6.3   76     6  24 1973-06-24
&gt; 56     NA     135  8.0   75     6  25 1973-06-25
&gt; 57     NA     127  8.0   78     6  26 1973-06-26
&gt; 58     NA      47 10.3   73     6  27 1973-06-27
&gt; 59     NA      98 11.5   80     6  28 1973-06-28
&gt; 60     NA      31 14.9   77     6  29 1973-06-29
&gt; 61     NA     138  8.0   83     6  30 1973-06-30
&gt; 62    135     269  4.1   84     7   1 1973-07-01
&gt; 63     49     248  9.2   85     7   2 1973-07-02
&gt; 64     32     236  9.2   81     7   3 1973-07-03
&gt; 65     NA     101 10.9   84     7   4 1973-07-04
&gt; 66     64     175  4.6   83     7   5 1973-07-05
&gt; 67     40     314 10.9   83     7   6 1973-07-06
&gt; 68     77     276  5.1   88     7   7 1973-07-07
&gt; 69     97     267  6.3   92     7   8 1973-07-08
&gt; 70     97     272  5.7   92     7   9 1973-07-09
&gt; 71     85     175  7.4   89     7  10 1973-07-10
&gt; 72     NA     139  8.6   82     7  11 1973-07-11
&gt; 73     10     264 14.3   73     7  12 1973-07-12
&gt; 74     27     175 14.9   81     7  13 1973-07-13
&gt; 75     NA     291 14.9   91     7  14 1973-07-14
&gt; 76      7      48 14.3   80     7  15 1973-07-15
&gt; 77     48     260  6.9   81     7  16 1973-07-16
&gt; 78     35     274 10.3   82     7  17 1973-07-17
&gt; 79     61     285  6.3   84     7  18 1973-07-18
&gt; 80     79     187  5.1   87     7  19 1973-07-19
&gt; 81     63     220 11.5   85     7  20 1973-07-20
&gt; 82     16       7  6.9   74     7  21 1973-07-21
&gt; 83     NA     258  9.7   81     7  22 1973-07-22
&gt; 84     NA     295 11.5   82     7  23 1973-07-23
&gt; 85     80     294  8.6   86     7  24 1973-07-24
&gt; 86    108     223  8.0   85     7  25 1973-07-25
&gt; 87     20      81  8.6   82     7  26 1973-07-26
&gt; 88     52      82 12.0   86     7  27 1973-07-27
&gt; 89     82     213  7.4   88     7  28 1973-07-28
&gt; 90     50     275  7.4   86     7  29 1973-07-29
&gt; 91     64     253  7.4   83     7  30 1973-07-30
&gt; 92     59     254  9.2   81     7  31 1973-07-31
&gt; 93     39      83  6.9   81     8   1 1973-08-01
&gt; 94      9      24 13.8   81     8   2 1973-08-02
&gt; 95     16      77  7.4   82     8   3 1973-08-03
&gt; 96     78      NA  6.9   86     8   4 1973-08-04
&gt; 97     35      NA  7.4   85     8   5 1973-08-05
&gt; 98     66      NA  4.6   87     8   6 1973-08-06
&gt; 99    122     255  4.0   89     8   7 1973-08-07
&gt; 100    89     229 10.3   90     8   8 1973-08-08
&gt; 101   110     207  8.0   90     8   9 1973-08-09
&gt; 102    NA     222  8.6   92     8  10 1973-08-10
&gt; 103    NA     137 11.5   86     8  11 1973-08-11
&gt; 104    44     192 11.5   86     8  12 1973-08-12
&gt; 105    28     273 11.5   82     8  13 1973-08-13
&gt; 106    65     157  9.7   80     8  14 1973-08-14
&gt; 107    NA      64 11.5   79     8  15 1973-08-15
&gt; 108    22      71 10.3   77     8  16 1973-08-16
&gt; 109    59      51  6.3   79     8  17 1973-08-17
&gt; 110    23     115  7.4   76     8  18 1973-08-18
&gt; 111    31     244 10.9   78     8  19 1973-08-19
&gt; 112    44     190 10.3   78     8  20 1973-08-20
&gt; 113    21     259 15.5   77     8  21 1973-08-21
&gt; 114     9      36 14.3   72     8  22 1973-08-22
&gt; 115    NA     255 12.6   75     8  23 1973-08-23
&gt; 116    45     212  9.7   79     8  24 1973-08-24
&gt; 117   168     238  3.4   81     8  25 1973-08-25
&gt; 118    73     215  8.0   86     8  26 1973-08-26
&gt; 119    NA     153  5.7   88     8  27 1973-08-27
&gt; 120    76     203  9.7   97     8  28 1973-08-28
&gt; 121   118     225  2.3   94     8  29 1973-08-29
&gt; 122    84     237  6.3   96     8  30 1973-08-30
&gt; 123    85     188  6.3   94     8  31 1973-08-31
&gt; 124    96     167  6.9   91     9   1 1973-09-01
&gt; 125    78     197  5.1   92     9   2 1973-09-02
&gt; 126    73     183  2.8   93     9   3 1973-09-03
&gt; 127    91     189  4.6   93     9   4 1973-09-04
&gt; 128    47      95  7.4   87     9   5 1973-09-05
&gt; 129    32      92 15.5   84     9   6 1973-09-06
&gt; 130    20     252 10.9   80     9   7 1973-09-07
&gt; 131    23     220 10.3   78     9   8 1973-09-08
&gt; 132    21     230 10.9   75     9   9 1973-09-09
&gt; 133    24     259  9.7   73     9  10 1973-09-10
&gt; 134    44     236 14.9   81     9  11 1973-09-11
&gt; 135    21     259 15.5   76     9  12 1973-09-12
&gt; 136    28     238  6.3   77     9  13 1973-09-13
&gt; 137     9      24 10.9   71     9  14 1973-09-14
&gt; 138    13     112 11.5   71     9  15 1973-09-15
&gt; 139    46     237  6.9   78     9  16 1973-09-16
&gt; 140    18     224 13.8   67     9  17 1973-09-17
&gt; 141    13      27 10.3   76     9  18 1973-09-18
&gt; 142    24     238 10.3   68     9  19 1973-09-19
&gt; 143    16     201  8.0   82     9  20 1973-09-20
&gt; 144    13     238 12.6   64     9  21 1973-09-21
&gt; 145    23      14  9.2   71     9  22 1973-09-22
&gt; 146    36     139 10.3   81     9  23 1973-09-23
&gt; 147     7      49 10.3   69     9  24 1973-09-24
&gt; 148    14      20 16.6   63     9  25 1973-09-25
&gt; 149    30     193  6.9   70     9  26 1973-09-26
&gt; 150    NA     145 13.2   77     9  27 1973-09-27
&gt; 151    14     191 14.3   75     9  28 1973-09-28
&gt; 152    18     131  8.0   76     9  29 1973-09-29
&gt; 153    20     223 11.5   68     9  30 1973-09-30
```

]

]

---

# Primer an√°lisis: datos de arrestos de EE.UU.


.panelset[
.panel[.panel-name[Carga]

El paquete llamado `{datasets}` contiene distintos conjuntos de datos reales


```r
# install.packages("datasets") # Descomentar si nunca se ha instalado
library(datasets)
```

Tras instalarlo, si escribimos `datasets::` y pulsamos tabulador, se nos abre un **desplegable con distintos conjuntos**. Vamos a practicar lo aprendido con `datasets::USArrests`, que contiene **estad√≠sticas de arrestos en 1973 (por cada 100 000 habitantes)**  en cada uno de los 50 estados de Estaods Unidos.


```r
datasets::USArrests
```

```
&gt;                Murder Assault UrbanPop Rape
&gt; Alabama          13.2     236       58 21.2
&gt; Alaska           10.0     263       48 44.5
&gt; Arizona           8.1     294       80 31.0
&gt; Arkansas          8.8     190       50 19.5
&gt; California        9.0     276       91 40.6
&gt; Colorado          7.9     204       78 38.7
&gt; Connecticut       3.3     110       77 11.1
&gt; Delaware          5.9     238       72 15.8
&gt; Florida          15.4     335       80 31.9
&gt; Georgia          17.4     211       60 25.8
&gt; Hawaii            5.3      46       83 20.2
&gt; Idaho             2.6     120       54 14.2
&gt; Illinois         10.4     249       83 24.0
&gt; Indiana           7.2     113       65 21.0
&gt; Iowa              2.2      56       57 11.3
&gt; Kansas            6.0     115       66 18.0
&gt; Kentucky          9.7     109       52 16.3
&gt; Louisiana        15.4     249       66 22.2
&gt; Maine             2.1      83       51  7.8
&gt; Maryland         11.3     300       67 27.8
&gt; Massachusetts     4.4     149       85 16.3
&gt; Michigan         12.1     255       74 35.1
&gt; Minnesota         2.7      72       66 14.9
&gt; Mississippi      16.1     259       44 17.1
&gt; Missouri          9.0     178       70 28.2
&gt; Montana           6.0     109       53 16.4
&gt; Nebraska          4.3     102       62 16.5
&gt; Nevada           12.2     252       81 46.0
&gt; New Hampshire     2.1      57       56  9.5
&gt; New Jersey        7.4     159       89 18.8
&gt; New Mexico       11.4     285       70 32.1
&gt; New York         11.1     254       86 26.1
&gt; North Carolina   13.0     337       45 16.1
&gt; North Dakota      0.8      45       44  7.3
&gt; Ohio              7.3     120       75 21.4
&gt; Oklahoma          6.6     151       68 20.0
&gt; Oregon            4.9     159       67 29.3
&gt; Pennsylvania      6.3     106       72 14.9
&gt; Rhode Island      3.4     174       87  8.3
&gt; South Carolina   14.4     279       48 22.5
&gt; South Dakota      3.8      86       45 12.8
&gt; Tennessee        13.2     188       59 26.9
&gt; Texas            12.7     201       80 25.5
&gt; Utah              3.2     120       80 22.9
&gt; Vermont           2.2      48       32 11.2
&gt; Virginia          8.5     156       63 20.7
&gt; Washington        4.0     145       73 26.2
&gt; West Virginia     5.7      81       39  9.3
&gt; Wisconsin         2.6      53       66 10.8
&gt; Wyoming           6.8     161       60 15.6
```

]

.panel[.panel-name[Detalles de datos]

**¬øQu√© tipo de objeto es?**


```r
class(datasets::USArrests)
```

```
&gt; [1] "data.frame"
```

**¬øC√≥mo buscar informaci√≥n de los datos?**


```r
? datasets::USArrests
```

**¬øQu√© variables tenemos?**


```r
names(datasets::USArrests)
```

```
&gt; [1] "Murder"   "Assault"  "UrbanPop" "Rape"
```

]

.panel[.panel-name[Dimensiones]

**¬øQu√© dimensiones tiene nuestro objeto?**

```r
dim(datasets::USArrests)
```

```
&gt; [1] 50  4
```

**¬øCu√°ntos estados tenemos con estad√≠sticas?**

```r
nrow(datasets::USArrests)
```

```
&gt; [1] 50
```

**¬øCu√°ntas variables se han medido en cada uno?**

```r
ncol(datasets::USArrests)
```

```
&gt; [1] 4
```
]


.panel[.panel-name[A√±adir columna]

En el conjunto de datos tenemos las **filas nombradas** (pero sin ser una variable).


```r
row.names(datasets::USArrests)[1:5] # los 5 primeros
```

```
&gt; [1] "Alabama"    "Alaska"     "Arizona"    "Arkansas"   "California"
```

**¬øC√≥mo podemos incluir dicho nombre como nueva columna?**


```r
tabla_nueva &lt;- data.frame("estado" = row.names(datasets::USArrests),
                          datasets::USArrests)
row.names(tabla_nueva) &lt;- NULL # ya no necesitamos los nombres de las filas
head(tabla_nueva) # Cabecera de la tabla
```

```
&gt;       estado Murder Assault UrbanPop Rape
&gt; 1    Alabama   13.2     236       58 21.2
&gt; 2     Alaska   10.0     263       48 44.5
&gt; 3    Arizona    8.1     294       80 31.0
&gt; 4   Arkansas    8.8     190       50 19.5
&gt; 5 California    9.0     276       91 40.6
&gt; 6   Colorado    7.9     204       78 38.7
```

]

.panel[.panel-name[Selecci√≥n ¬´cl√°sica¬ª]

**¬øC√≥mo seleccionar solo las columnas `Murder` y `Assault` para el segundo y el d√©cimo estado?**


```r
USArrests[c(2, 10), c("Murder", "Assault")]
```

```
&gt;         Murder Assault
&gt; Alaska    10.0     263
&gt; Georgia   17.4     211
```

]

.panel[.panel-name[Subset]

Tenemos adem√°s a nuestro disposici√≥n una **herramienta muy potente**: la funci√≥n `subset()`. Dicha funci√≥n nos va a permitir **seleccionar filas y columnas a la vez** con argumentos:

* `x`: un `data.frame` de entrada.
* `subset`: **condici√≥n l√≥gica** para **seleccionar registros (filas)**.
* `select`: un vector que contenga el **nombre de las columnas que queremos seleccionar**.

Por ejemplo, vamos a seleccionar solo los **delitos de asesinato y agresi√≥n** de aquellos **estados** cuyo porcentaje de **poblaci√≥n urbana sea superior al 80%**.


```r
subset(USArrests, subset = UrbanPop &gt; 80, select = c("Murder", "Assault"))
```

```
&gt;               Murder Assault
&gt; California       9.0     276
&gt; Hawaii           5.3      46
&gt; Illinois        10.4     249
&gt; Massachusetts    4.4     149
&gt; Nevada          12.2     252
&gt; New Jersey       7.4     159
&gt; New York        11.1     254
&gt; Rhode Island     3.4     174
```


]
]

---

name: estructuras
class: center, middle

# Extra: estructuras de control

## **if-else y bucles**

&amp;nbsp;

A veces necesitaremos algunas estructuras de control para guiar nuestro c√≥digo

---

# Estructuras if-else

`if-else` es una de las **estructuras de control** m√°s famosas: **SI** las condiciones impuestas se cumplen (`TRUE`), ejecuta las **√≥rdenes que tengamos dentro del `if {}`. 


```r
edades &lt;- c(14, 17, 24, 56, 31, 20, 87, 73)
if (any(edades &lt; 18)) { # TRUE si al menos una persona mayor de edad
  print("existe alguna persona mayor de edad")
}
```

```
&gt; [1] "existe alguna persona mayor de edad"
```


```r
if (all(edades &gt;= 18)) { # TRUE si TODOS son mayores de edad
  print("todas las personas son mayores de edad")
}
```

Si no se cumple no hace nada salvo que a√±adamos un `else {}` (con lo que sucede cuando no sucede)


```r
if (all(edades &gt;= 18)) { # TRUE si TODOS son mayores de edad
  print("todas las personas son mayores de edad")
} else { # si hay alguno menor de edad 
  print("existe alguna persona menor de edad")
}
```

```
&gt; [1] "existe alguna persona menor de edad"
```


---

# Bucles (a evitar)

* `for`: bucle que permite **repetir** el mismo c√≥digo un **n√∫mero fijo** de veces.


```r
library(glue)
nombres &lt;- c("Javi", "Laura")
edades &lt;- c(32, 51)

# Recorremos cada uno de los nombres e imprimimos un mensaje que depende de i
*for (i in 1:length(nombres)) {
  print(glue("{nombres[i]} tiene {edades[i]} a√±os")) 
}
```

```
&gt; Javi tiene 32 a√±os
&gt; Laura tiene 51 a√±os
```

* `while`: **repetir** un **n√∫mero indeterminado** de veces hasta que se **deje de cumplir una condici√≥n**.


```r
ciclos &lt;- 1
*while(ciclos &lt;= 3) {
  print(paste("Todav√≠a no, vamos por el ciclo ", ciclos))
  ciclos &lt;- ciclos + 1
}
```

```
&gt; [1] "Todav√≠a no, vamos por el ciclo  1"
&gt; [1] "Todav√≠a no, vamos por el ciclo  2"
&gt; [1] "Todav√≠a no, vamos por el ciclo  3"
```

---

name: proyecto-funciones
class: center, middle

# Primer proyecto. Uso de funciones

## **encapsulando y ordenando nuestro c√≥digo**

&amp;nbsp;

Un proyecto ser√° una ¬´carpeta¬ª dentro de `RStudio`. Las funciones nos servir√°n para encapsular nuestro c√≥digo.

---

# Proyecto

Cuando se empieza a programar para un trabajo concreto de `R` es recomendable crearnos lo que se conoce como un **proyecto de trabajo**: en lugar de ir abriendo ventanas sueltas para programar, podemos agruparlos en proyectos, de forma que podamos acceder a ellos de forma **ordenada**

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/crear_proyecto1.jpg" alt = "course-ECI" align = "left" width = "220" style = "margin-top: 5vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/crear_proyecto2.jpg" alt = "course-ECI" align = "middle" width = "220" style = "margin-top: 5vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/crear_proyecto3.jpg" alt = "course-ECI" align = "right" width = "250" style = "margin-top: 5vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/crear_proyecto4.jpg" alt = "course-ECI" align = "right" width = "250" style = "margin-top: 5vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;


---

# Funciones

No solo podemos usar las funciones predeterminadas, como `sum()` o `paste()`, sino que adem√°s podemos **crear nuestras propias funciones**, para automatizar **tareas que vayamos a repetir**

**¬øC√≥mo crear nuestra propia funci√≥n?** Veamos su **esquema b√°sico**:

* Un **nombre**, por ejemplo `nombre_funcion`.
* A dicho nombre le asignamos `&lt;-` la palabra reservada `function()`.
* Dentro de `function()` definimos los **argumentos de entrada**.
* Dentro de `{}` incluiremos las √≥rdenes.
* Finalizaremos la funci√≥n con `return()` indicando lo que queremos **devolver**.


```r
nombre_funcion &lt;- function(argumento_1, argumento_2, ... ) {
  
  # C√≥digo que queramos ejecutar en la funci√≥n
  c√≥digo
  
  # Salida
  return(variable_salida)
}
```

**IMPORTANTE**: todas las variables que definamos dentro de la funci√≥n son **variables locales, solo existir√°n dentro de la funci√≥n** salvo que especifiquemos lo contrario.

---

# Funciones

Un **ejemplo muy simple**: una funci√≥n para **calcular el √°rea de un rect√°ngulo**. Los **argumentos de entrada** ser√°n los **lados** y el valor a **devolver** ser√° el √°rea (el producto de los lados).


```r
# Definici√≥n del nombre de funci√≥n y argumentos de entrada
calcular_area &lt;- function(lado_1, lado_2) {

  # Resultado que devolvemos
  return(lado_1 * lado_2)
  
}
```

**¬øC√≥mo aplicar la funci√≥n?**


```r
# Aplicaci√≥n de la funci√≥n con los par√°metros por defecto
calcular_area(5, 3) # √°rea de un rect√°ngulo 5 x 3 
```

```
&gt; [1] 15
```

---

# Funciones

Imagina que nos damos cuenta que el **90% de las veces el √°rea que nos toca calcular fuese la de un cuadrado**, es decir, solo necesitamos un argumento, un lado: `R` nos permite **definir argumentos por defecto** en la funci√≥n (tomar√°n dicho valor salvo que le asignemos otro).

**¬øPor qu√© no asignar `lado_2 = lado_1` por defecto?**


```r
# Definici√≥n del nombre de funci√≥n y argumentos de entrada
calcular_area &lt;- function(lado_1, lado_2 = lado_1) {
  
  # Cuerpo de la funci√≥n
  area &lt;- lado_1 * lado_2
  
  # Resultado que devolvemos
  return(area)
  
}
```

Ahora, **si no indicamos nada por defecto el segundo lado ser√° igual al primero** (un cuadrado).


```r
calcular_area(lado_1 = 5)
```

```
&gt; [1] 25
```

---

# Funciones

**Compliquemos un poco la funci√≥n** y a√±adamos en la salida los valores de cada lado.


```r
calcular_area &lt;- function(lado_1, lado_2 = lado_1) {
  
  # Cuerpo de la funci√≥n
  area &lt;- lado_1 * lado_2
  
  # Resultado
  return(c("area" = area, "lado_1" = lado_1, "lado_2" = lado_2))
}

salida &lt;- calcular_area(lado_1 = 5, lado_2 = 3)
salida
```

```
&gt;   area lado_1 lado_2 
&gt;     15      5      3
```

```r
salida["area"]
```

```
&gt; area 
&gt;   15
```

---

# Ejercicios


.panelset[
.panel[.panel-name[Ejercicios]


* üìù **Ejercicio 1**: modifica el c√≥digo inferior para definir una funci√≥n llamada `funcion_suma`, de forma que dados dos elementos, devuelve su suma.


```r
# Definimos funci√≥n
nombre &lt;- function(x, y) {
  # Sumamos
  suma &lt;- # c√≥digo a ejecutar
  # ¬øQu√© devolvemos?
  return()
}
```

* üìù **Ejercicio 2**: modifica el c√≥digo para definir una funci√≥n llamada `funcion_producto`, de forma que dados dos elementos, devuelve su producto.

* üìù **Ejercicio 3**: modifica el c√≥digo para definir una funci√≥n llamada `funcion_producto`, pero que por defecto calcule el cuadrado.

* üìù **Ejercicio 4**: define una funci√≥n llamada igualdad_nombres que, dados dos `nombres persona_1` e `persona_2`, nos diga si son iguales o no. Hazlo considerando importantes las may√∫sculas, y sin que importen las may√∫sculas. Recuerda que con `toupper()` podemos pasar todo un texto a may√∫scula.

]

.panel[.panel-name[Soluci√≥n Ej. 1]


```r
# Definimos funci√≥n
funcion_suma &lt;- function(x, y) {
  
  # Sumamos
  suma &lt;- x + y
  
  # Devolvemos la salida
  return(suma)
}

# Aplicamos la funci√≥n
funcion_suma(3, 7)
```

```
&gt; [1] 10
```

]

.panel[.panel-name[Soluci√≥n Ej. 2]


```r
# Definimos funci√≥n
funcion_producto &lt;- function(x, y) {
  
  # Multiplicamos
  producto &lt;- x * y
  
  # Devolvemos la salida
  return(producto)
}

# Aplicamos la funci√≥n
funcion_producto(3, -7)
```

```
&gt; [1] -21
```

]

.panel[.panel-name[Soluci√≥n Ej. 3]


```r
# Definimos funci√≥n
funcion_producto &lt;- function(x, y = x) {
  
  # Multiplicamos
  producto &lt;- x * y
  
  # Devolvemos la salida
  return(producto)
}

# Aplicamos la funci√≥n
funcion_producto(3) # por defecto x = 3, y = 3
```

```
&gt; [1] 9
```

```r
funcion_producto(3, -7)
```

```
&gt; [1] -21
```
]

.panel[.panel-name[Soluci√≥n Ej. 4]

```r
# Distinguiendo may√∫sculas
igualdad_nombres &lt;- function(persona_1, persona_2) {
  
  return(persona_1 == persona_2)
}
igualdad_nombres("Javi", "javi")
```

```
&gt; [1] FALSE
```

```r
igualdad_nombres("Javi", "Luc√≠a")
```

```
&gt; [1] FALSE
```

```r
# Sin importar may√∫sculas
igualdad_nombres &lt;- function(persona_1, persona_2) {
  
  return(toupper(persona_1) == toupper(persona_2))
}
igualdad_nombres("Javi", "javi")
```

```
&gt; [1] TRUE
```

```r
igualdad_nombres("Javi", "Luc√≠a")
```

```
&gt; [1] FALSE
```
]

]
---

name: tibble
class: center, middle

# Mejorando los datos: tibble

## **mejorando los data.frame**

&amp;nbsp;

Un **dato de tipo tibble** ser√° un `data.frame` mejorado: m√°s √°gil, m√°s r√°pido y m√°s c√≥modo.

---

# Resumen de datos

.pull-left[&lt;img src = "https://miro.medium.com/max/727/0*MgEQsDgZZ7fJcdhZ.png" alt = "course-ECI" align = "left" width = "450" style = "margin-top: -5vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

Imagen de https://medium.com/@tiwarigaurav2512
]

.pull-right[

* **Celdas**: num√©ricas, texto, l√≥gicas, fecha, etc.
* **Vectores**: variables, colecci√≥n de celdas del mismo tipo.
* **Matrices**: colecci√≥n de variables, del mismo tipo e igual longitud.
* **data.frame**: colecci√≥n de variables, de igual longitud pero cualquier tipo.


* `if-else`, bucles, funciones
]

Un dato que no hemos comentado son las **listas**: una colecci√≥n de variables de cualquier tipo y longitud.


```r
list("a" = 1:2, "b" = data.frame("d1" = 1:2, "d2" = 3:4))
```

```
&gt; $a
&gt; [1] 1 2
&gt; 
&gt; $b
&gt;   d1 d2
&gt; 1  1  3
&gt; 2  2  4
```

---

# Tibble

Los **datos en formato tibble** (del paquete `{tibble}`) son un tipo de `data.frame` mejorado, para una **gesti√≥n m√°s √°gil, eficiente y coherente**. Las tablas en formato `tibble` tienen **4 ventajas principales**:

* Imprime **mayor informaci√≥n de las variables**, y solo **imprime por defecto las primeras filas**.


```r
library(tibble)
# tibble
tabla_tb &lt;- tibble("x" = 1:30, "y" = rep(c("a", "b", "c"), 10),
                   "z" = 31:60, "logica" = rep(c(TRUE, TRUE, FALSE), 10))
tabla_tb
```

```
&gt; # A tibble: 30 √ó 4
&gt;        x y         z logica
&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;lgl&gt; 
&gt;  1     1 a        31 TRUE  
&gt;  2     2 b        32 TRUE  
&gt;  3     3 c        33 FALSE 
&gt;  4     4 a        34 TRUE  
&gt;  5     5 b        35 TRUE  
&gt;  6     6 c        36 FALSE 
&gt;  7     7 a        37 TRUE  
&gt;  8     8 b        38 TRUE  
&gt;  9     9 c        39 FALSE 
&gt; 10    10 a        40 TRUE  
&gt; # ‚Ä¶ with 20 more rows
```

---

# Tibble

Los **datos en formato tibble** (del paquete `{tibble}`) son un tipo de `data.frame` mejorado, para una **gesti√≥n m√°s √°gil, eficiente y coherente**. Las tablas en formato `tibble` tienen **4 ventajas principales**:

* Mantiene la **integridad de los datos** (no cambia los tipos de las variables y hace una carga de datos inteligente).


```r
tibble("fecha" = as.Date(c("1989-01-01", "1989-02-01", "1989-03-01")),
       "valores" = 1:3)
```

```
&gt; # A tibble: 3 √ó 2
&gt;   fecha      valores
&gt;   &lt;date&gt;       &lt;int&gt;
&gt; 1 1989-01-01       1
&gt; 2 1989-02-01       2
&gt; 3 1989-03-01       3
```

---

# Tibble

Los **datos en formato tibble** (del paquete `{tibble}`) son un tipo de `data.frame` mejorado, para una **gesti√≥n m√°s √°gil, eficiente y coherente**. Las tablas en formato `tibble` tienen **4 ventajas principales**:

* La funci√≥n `tibble()` **construye las variables secuencialmente**.


```r
# data.frame
data.frame("x" = 1:3, "z" = 11:13, "x*z" = x * z)
```

```
&gt; Error in x * z: arreglos de dimens√≥n no compatibles
```


```r
# tibble
tabla_tb &lt;- tibble("x" = 1:3, "z" = 11:13, "x*z" = x * z)
tabla_tb
```

```
&gt; # A tibble: 3 √ó 3
&gt;       x     z `x*z`
&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;
&gt; 1     1    11    11
&gt; 2     2    12    24
&gt; 3     3    13    39
```

---

# Tibble

Puedes consultar **m√°s funcionalidades** de dichos datos en &lt;https://tibble.tidyverse.org/&gt;

Ahora adem√°s de poder ver una cabecera de las filas con `head()` tenemos la funci√≥n `glimpse()`, que nos permite **obtener el resumen de columnas**


```r
head(tabla_tb)
```

```
&gt; # A tibble: 3 √ó 3
&gt;       x     z `x*z`
&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;
&gt; 1     1    11    11
&gt; 2     2    12    24
&gt; 3     3    13    39
```

```r
glimpse(tabla_tb)
```

```
&gt; Rows: 3
&gt; Columns: 3
&gt; $ x     &lt;int&gt; 1, 2, 3
&gt; $ z     &lt;int&gt; 11, 12, 13
&gt; $ `x*z` &lt;int&gt; 11, 24, 39
```

Si ya tienes un `data.frame` es altamente recomendable **convertirlo a tibble** con `as_tibble()`

---

# Ejercicios

.panelset[
.panel[.panel-name[Ejercicios]


* üìù **Ejercicio 1**: ¬øes el conjunto de datos `airquality` (del paquete `{datasets}`) de tipo tibble?
 

* üìù **Ejercicio 2**: convierte el conjunto `airquality` de `data.frame` a `tibble`.
 
* üìù **Ejercicio 3**: define un tibble con tres variables num√©ricas `a, b, c`, tal que la tercera sea el producto de las dos primeras `c = a * b`.
 

* üìù **Ejercicio 4**: define un `tibble` con tres variables de nombres variable, 2, tercera :), e intenta acceder a ellas.
 

* üìù **Ejercicio 5**: obten de los paquetes `{dplyr}` y `{gapminder}` los conjuntos de datos `starwars` y `gapminder`. Comprueba el n√∫mero de variables, de registros e imprime los datos.
]


.panel[.panel-name[Soluci√≥n Ej. 1]


```r
library(datasets)
head(airquality)
```

```
&gt;   Ozone Solar.R Wind Temp Month Day
&gt; 1    41     190  7.4   67     5   1
&gt; 2    36     118  8.0   72     5   2
&gt; 3    12     149 12.6   74     5   3
&gt; 4    18     313 11.5   62     5   4
&gt; 5    NA      NA 14.3   56     5   5
&gt; 6    28      NA 14.9   66     5   6
```

```r
class(airquality)
```

```
&gt; [1] "data.frame"
```
]

.panel[.panel-name[Soluci√≥n Ej. 2]


```r
as_tibble(airquality)
```

```
&gt; # A tibble: 153 √ó 6
&gt;    Ozone Solar.R  Wind  Temp Month   Day
&gt;    &lt;int&gt;   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
&gt;  1    41     190   7.4    67     5     1
&gt;  2    36     118   8      72     5     2
&gt;  3    12     149  12.6    74     5     3
&gt;  4    18     313  11.5    62     5     4
&gt;  5    NA      NA  14.3    56     5     5
&gt;  6    28      NA  14.9    66     5     6
&gt;  7    23     299   8.6    65     5     7
&gt;  8    19      99  13.8    59     5     8
&gt;  9     8      19  20.1    61     5     9
&gt; 10    NA     194   8.6    69     5    10
&gt; # ‚Ä¶ with 143 more rows
```

```r
class(as_tibble(airquality))
```

```
&gt; [1] "tbl_df"     "tbl"        "data.frame"
```

```r
glimpse(as_tibble(airquality))
```

```
&gt; Rows: 153
&gt; Columns: 6
&gt; $ Ozone   &lt;int&gt; 41, 36, 12, 18, NA, 28, 23, 19, 8, NA, 7, 16, 11, 14, 18, 14, ‚Ä¶
&gt; $ Solar.R &lt;int&gt; 190, 118, 149, 313, NA, NA, 299, 99, 19, 194, NA, 256, 290, 27‚Ä¶
&gt; $ Wind    &lt;dbl&gt; 7.4, 8.0, 12.6, 11.5, 14.3, 14.9, 8.6, 13.8, 20.1, 8.6, 6.9, 9‚Ä¶
&gt; $ Temp    &lt;int&gt; 67, 72, 74, 62, 56, 66, 65, 59, 61, 69, 74, 69, 66, 68, 58, 64‚Ä¶
&gt; $ Month   &lt;int&gt; 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5,‚Ä¶
&gt; $ Day     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,‚Ä¶
```

]

.panel[.panel-name[Soluci√≥n Ej. 3]


```r
tibble("a" = 1:5, "b" = 11:15, "c" = a * b)
```

```
&gt; # A tibble: 5 √ó 3
&gt;       a     b     c
&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;
&gt; 1     1    11    11
&gt; 2     2    12    24
&gt; 3     3    13    39
&gt; 4     4    14    56
&gt; 5     5    15    75
```

]

.panel[.panel-name[Soluci√≥n Ej. 4]


```r
# Definimos el tibble
datos_tb &lt;- tibble("variable" = 1:7, "tercera falsa :)" = 0, "2" = 11:17)
# Accedemos a sus columnas
datos_tb$variable
```

```
&gt; [1] 1 2 3 4 5 6 7
```

```r
datos_tb$`tercera falsa :)`
```

```
&gt; [1] 0 0 0 0 0 0 0
```

```r
datos_tb$`2`
```

```
&gt; [1] 11 12 13 14 15 16 17
```

]

.panel[.panel-name[5a]


```r
dplyr::starwars
```

```
&gt; # A tibble: 87 √ó 14
&gt;    name    height  mass hair_color  skin_color eye_color birth_year sex   gender
&gt;    &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
&gt;  1 Luke S‚Ä¶    172    77 blond       fair       blue            19   male  mascu‚Ä¶
&gt;  2 C-3PO      167    75 &lt;NA&gt;        gold       yellow         112   none  mascu‚Ä¶
&gt;  3 R2-D2       96    32 &lt;NA&gt;        white, bl‚Ä¶ red             33   none  mascu‚Ä¶
&gt;  4 Darth ‚Ä¶    202   136 none        white      yellow          41.9 male  mascu‚Ä¶
&gt;  5 Leia O‚Ä¶    150    49 brown       light      brown           19   fema‚Ä¶ femin‚Ä¶
&gt;  6 Owen L‚Ä¶    178   120 brown, grey light      blue            52   male  mascu‚Ä¶
&gt;  7 Beru W‚Ä¶    165    75 brown       light      blue            47   fema‚Ä¶ femin‚Ä¶
&gt;  8 R5-D4       97    32 &lt;NA&gt;        white, red red             NA   none  mascu‚Ä¶
&gt;  9 Biggs ‚Ä¶    183    84 black       light      brown           24   male  mascu‚Ä¶
&gt; 10 Obi-Wa‚Ä¶    182    77 auburn, wh‚Ä¶ fair       blue-gray       57   male  mascu‚Ä¶
&gt; # ‚Ä¶ with 77 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,
&gt; #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;
```

```r
dim(dplyr::starwars)
```

```
&gt; [1] 87 14
```

]

.panel[.panel-name[5b]


```r
library(gapminder)
gapminder
```

```
&gt; # A tibble: 1,704 √ó 6
&gt;    country     continent  year lifeExp      pop gdpPercap
&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
&gt;  1 Afghanistan Asia       1952    28.8  8425333      779.
&gt;  2 Afghanistan Asia       1957    30.3  9240934      821.
&gt;  3 Afghanistan Asia       1962    32.0 10267083      853.
&gt;  4 Afghanistan Asia       1967    34.0 11537966      836.
&gt;  5 Afghanistan Asia       1972    36.1 13079460      740.
&gt;  6 Afghanistan Asia       1977    38.4 14880372      786.
&gt;  7 Afghanistan Asia       1982    39.9 12881816      978.
&gt;  8 Afghanistan Asia       1987    40.8 13867957      852.
&gt;  9 Afghanistan Asia       1992    41.7 16317921      649.
&gt; 10 Afghanistan Asia       1997    41.8 22227415      635.
&gt; # ‚Ä¶ with 1,694 more rows
```

```r
dim(gapminder)
```

```
&gt; [1] 1704    6
```

]

]


---

name: rmarkdown
class: center, middle

# Caso pr√°ctico: informe RMarkdown

## **presentado nuestros an√°lisis**

&amp;nbsp;

`Rmarkdown` es una herramienta para juntar en un mismo documento `markdown` (como el lenguaje marcado que se usa para wordpress o newsletter), c√≥digo `R`, im√°genes, f√≥rmulas, etc

---

# Rmarkdown

Vamos acabar nuestra primera sesi√≥n de `R` con una **forma pr√°ctica de presentar** nuestros an√°lisis y resultados, y que ser√° el formato en el que pedir√°n las **pr√°cticas evaluables**: hablemos de **Rmarkdown**.


Una de las principales **fortalezas** de `R` frente a `Python` es, no solo la visualizaci√≥n de datos, sino sus **opciones para generar informes**, incluso **libros**, **webs**, apuntes y hasta **diapositivas** (tanto el manual como estas mismas diapositivas han sido basadas en paquetes usan `{rmarkdown}`.


```r
install.packages("rmarkdown")
```

&lt;img src = "https://rubenfcasal.github.io/bookdown_intro/images/rmarkdown.png" alt = "rmd" align = "left" width = "280" style = "margin-top: 3vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;


---


# Rmarkdown

**¬øCu√°l es la ventaja de generarlos desde rmarkdown?**

La m√°s obvia: lo podemos hacer desde `RStudio` sin salirnos del entorno de programaci√≥n, e integrar f√°cilmente **c√≥digo R**.

&lt;img src = "https://d33wubrfki0l68.cloudfront.net/87603549ad0d95b0071da0f9270b2f89ead3b39b/48700/lesson-images/websites-1-render.png" alt = "rmd" align = "left" width = "500" style = "margin-top: 3vh;margin-right: 3rem;margin-left: 0.5rem;"&gt;

**¬øQu√© es Rmarkdown?**

Una **herramienta** que nos permite crear de forma sencilla documentos:

* **Markdown**: creado en 2004 por John Gruber, y de uso libre, es un **¬´lenguaje¬ª que nos permite crear contenido** con un dise√±o legible, permitiendo la inclusi√≥n sencilla de p√°rrafos, negritas, cursivas, etc. Si acostumbras a escribir en **wordpress, blogs u otras plataformas**, seguramente hayas escrito de esta forma (sin saberlo quiz√°s).
* **Latex**:  para escribir notaci√≥n matem√°tica como `\(x^2\)`.
* **C√≥digo y salidas de R**.
* **Im√°genes**
* **Estilos (css, js, etc)**

---

# Rmarkdown

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/file_rmarkdown.jpg" alt = "rmd" align = "left" width = "300" style = "margin-top: 3vh;margin-right: 3rem;margin-left: 0.5rem;"&gt;


**Crear un Rmarkdown**: para crear el primero fichero con extensi√≥n `.rmd` (la extensi√≥n de los archivos `R Markdown`). Tras hacer click en el bot√≥n `File &lt;&lt; New File &lt;&lt; R Markdown`, nos aparecer√° un men√∫ con varias opciones.


&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/new_rmd.jpg" alt = "rmd" align = "left" width = "350" style = "margin-top: 3vh;margin-right: 3rem;margin-left: 0.5rem;"&gt;

* **Formatos de salida**: `.pdf`, `.html` (documento din√°mico, permite la interacci√≥n con el usuario, como una ¬´p√°gina web¬ª), `.doc` (nada recomendable)
* **T√≠tulo (title)**: t√≠tulo de nuestro documento. 
* **Autor (author)**: autor del documento.

---

# Rmarkdown


&lt;img src="./img/rmd_estructura.jpg" width="55%" /&gt;


Un fichero `.Rmd` se divide b√°sicamente en **tres partes**

* **Cabecera**: el inicio que hay entre `---` (los ajustes del documento general).
* **Texto**: texto escrito que con markdown podremos mejorar con **negritas** (escrito como `**negritas**`, con doble ast√©risco al inicio y final), _cursivas_ (`_cursivas_`, con barra baja al inicio y final) o destacar nombres de funciones o `variables de R`. Recuerda que puedes a√±adir adem√°s **ecuaciones** como `\(x^2\)` (he escrito `$x^2$`, la ecuaci√≥n entre d√≥lares).
* **C√≥digo R**: las cajitas donde metamos nuestro c√≥digo `R` se llamar√°n **chunks**.

**IMPORTANTE**: salvo que indiquemos lo contrario con **chunks**, todo lo que vamos a escribir en el documento es texto. No c√≥digo R.

---

# Cabecera

La **cabecera est√°n en formato YAML**, y contiene los **metadatos** del documento: t√≠tulo, autor, fecha, estilos (si los tuvi√©semos), etc. Vamos a cambiar la cabecera que nos ha generado por defecto de la siguiente forma:

* **Title**: `"Probando Probando"`
* **author**: `"Se√±or X"`
* **date**: `"11/7/2014"`
* **output**: `html_document`

Le indicamos el **formato de salida**, en este caso un **documento HTML**.

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/rmd_vacio.jpg" alt = "rmd" align = "left" width = "500" style = "margin-top: 3vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

---

# Cuerpo de texto

Para empezar nuestro documento escribiremos, por ejemplo, la siguiente frase

&gt; Este material ha sido dise√±ado como complemento y recursos de apoyo al curso de la Escuela de Invierno de la UCM titulado ¬´Analizando datos, visualizando informaci√≥n, contando historias¬ª, celebrado presencialmente del 31 de enero al 4 de febrero de 2022 (16:00 a 21:00 horas, de lunes a viernes).

**Guardamos** el archivo `.Rmd` haciendo click en el bot√≥n Guardar y **tejeremos** nuestro documento haciendo click en el bot√≥n `Knit`.


&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/primer_html_rmd.jpg" alt = "rmd" align = "left" width = "400" style = "margin-top: 3vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

---

# A√±adiendo formato

Podemos **mejorar un poco el texto**:

* Vamos a a√±adir **negrita** a la frase `"curso de la Escuela de Invierno de la UCM"` (poniendo ** al inicio y al final).

--

* Vamos a√±adir **cursiva** a la palabra `"material"` (poniendo _ al inicio y al final).

--

* Vamos a√±adir un **enlace**, &lt;https://www.ucm.es/eci//cursoecic02-pre&gt;, asoci√°ndolo al t√≠tulo `¬´Analizando datos, visualizando informaci√≥n, contando historias¬ª`. Para ello el t√≠tulo lo ponemos entre corchetes y justo detr√°s el enlace entre par√©ntesis [¬´Analizando datos, visualizando informaci√≥n, contando historias¬ª](https://www.ucm.es/eci//cursoecic02-pre)

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/rmd_2.jpg" alt = "rmd" align = "left" width = "520" style = "margin-top: 3vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

--

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/html_rmd_2.jpg" alt = "rmd" align = "left" width = "380" style = "margin-top: 3vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

---

# Chunks de c√≥digo

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/chunk_1.jpg" alt = "rmd" align = "left" width = "400" style = "margin-top: 2vh;margin-right: 1rem;margin-left: 0.5rem;"&gt;


Nuestras **cajas de c√≥digo** llamadas _chunks_ ser√°n altos en el camino en nuestro texto _markdown_ donde podremos incluir c√≥digo. Para incluir uno deber√° de ir **encabezado** de la siguiente forma.

--

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/rmd_3.jpg" alt = "rmd" align = "left" width = "530" style = "margin-top: 1vh;margin-right: 1rem;margin-left: 0.5rem;"&gt;

Dentro de la cajita **escribiremos c√≥digo R**, como lo ven√≠amos haciendo hasta ahora. Vamos por ejemplo a **definir dos variables y su suma**. Dentro de esos _chunks_ puedes **comentar c√≥digo** como hacemos habitualmente con `#`.

Tras tejer de nuevo y obtenemos ahora un documento que tiene una caja de c√≥digo y su salida, en este caso `x + y`.
 
---

# Etiquetando chunks

Los _chunks_ de c√≥digo pueden tener un **nombre o etiqueta** para poder referenciarlos de nuevo (y para no repetir c√≥digo). En la etiqueta no se pueden poner espacios, preferiblemente solo letras y guiones.

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/chunk_repe_tag.jpg" alt = "rmd" align = "left" width = "500" style = "margin-top: 3vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/html_tag_chunk.jpg" alt = "rmd" align = "left" width = "500" style = "margin-top: 3vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;


---

# Organizando el documento

El **documento podemos dividirlo en secciones y subsecciones**. Para ello usaremos la sintaxis de _markdown_, poniendo **almohadillas**: una `#` para secciones, `##` para subsecciones, `###` para subsubsecciones, etc. Vamos a crear una **secci√≥n principal** que sea `# Primer informe` y una **subsecci√≥n** que se titule `## Chunks de c√≥digo` donde incluiremos los dos chunks que tenemos hasta ahora.

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/secciones_rmd.jpg" alt = "rmd" align = "left" width = "450" style = "margin-top: 2vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

Tambi√©n podemos **organizar nuestro documento** creando listas de √≠tems, usando `*` para cada uno de ellos.

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/items_rmd.jpg" alt = "rmd" align = "left" width = "450" style = "margin-top: 2vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

---

# Ejecutando chunk a chunk

En cada _chunk_ aparece una bot√≥n de _play_: puls√°ndolo podemos tener la **ejecuci√≥n y salida de cada chunk** en nuestro `.Rmd`, sin tener que esperar a ¬´tejer¬ª (con Knit) todo el documento para ver lo que vamos ejecutando.

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/play_chunk.jpg" alt = "rmd" align = "left" width = "500" style = "margin-top: 2vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/chunk_ejecutado.jpg" alt = "rmd" align = "left" width = "500" style = "margin-top: 2vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

Adem√°s **podemos incluir c√≥digo R dentro de la l√≠nea de texto**.


&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/codigo_inline_rmd.jpg" alt = "rmd" align = "right" width = "450" style = "margin-top: 2vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

---

# Personalizando chunks

Los _chunks_ podemos **personalizarlos** con algunas opciones, pas√°ndolos como argumentos dentro de las llaves `{r etiqueta, ...}`.

* `include = FALSE`: se **ejecuta el c√≥digo** pero **no se muestra** ni c√≥digo ni resultados en la salida final (pero lo que se ejecuta puede ser usado en otros chunks futuros). Por ejemplo, `{r etiqueta, include = FALSE}`

* `echo = FALSE`: se **ejecuta el c√≥digo** y se **muestra el resultado** pero **no el c√≥digo** en la salida final. Por ejemplo, `{r etiqueta, echo = FALSE}`
 
* `eval = FALSE`: se **muestra** pero **no se ejecuta** el c√≥digo en la salida final.

* `message = FALSE`: se **ejecuta el c√≥digo** pero **no se muestran los mensajes** de salida que tendr√≠amos en consola (en caso de existir).

* `warning = FALSE`: se **ejecuta el c√≥digo** pero **no se muestran los warning** que tendr√≠amos en consola (en caso de existir).

* `error = TRUE`: se **ejecuta el c√≥digo** pero permite ejecutar el c√≥digo **con errores** mostrando los mensajes de error que tendr√≠amos en consola (en caso de existir).

Puedes ver las **diferentes salidas** en el archivo [primer_rmarkdown.Rmd](https://github.com/dadosdelaplace/courses-ECI-2022/blob/main/scripts/primer_rmarkdown.Rmd)


---

# Variables y ecuaciones

Tambi√©n podemos **incluir ecuaciones** haciendo uso de c√≥digo latex (entre dolares `$$`), as√≠ como nombres de variables.

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/variables_rmd.jpg" alt = "rmd" align = "left" width = "600" style = "margin-top: 2vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;

&lt;img src = "https://dadosdelaplace.github.io/courses-ECI-2022/img/variables_html.jpg" alt = "rmd" align = "left" width = "600" style = "margin-top: 2vh;margin-right: 0.5rem;margin-left: 0.5rem;"&gt;


---
name: evaluacion
class: center, middle

# EVALUACI√ìN

## **Pr√°ctica evaluable I: informes en Rmarkdown**

&amp;nbsp;

En la carpeta [EVALUACI√ìN](https://github.com/dadosdelaplace/courses-ECI-2022/tree/main/EVALUACI%C3%93N), accede al fichero `Evaluacion_1.Rmd` en la carpeta `PR√ÅCTICA I`. Dicho archivo es una plantilla de archivo `.Rmd` en el que se te hacen diferentes preguntas sobre un conjunto de datos y debes responderlas dentro del propio fichero y estructura `.Rmd`.

&amp;nbsp;

La **entrega de las cinco pr√°cticas** deber√°n ser enviadas por mail antes de las 23:59h del 11 de febrero, todas en un archivo comprimido (`.zip`, `.rar`, etc), con el nombre de el/la alumno/a.

---

class: center, middle

# Ma√±ana m√°s y mejor. ¬°Much√≠simas gracias a todos/as!

Las diapositivas han sido generadas con el paquete [**{xaringan}**](https://github.com/yihui/xaringan).


Los estilos (.css y .js) de estas diapositivas est√°n basados en las diapositivas del repositorio &lt;https://github.com/dieghernan/rpubs&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
